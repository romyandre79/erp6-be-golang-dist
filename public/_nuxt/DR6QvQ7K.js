import{u as h}from"./BJSp6O0t.js";import{u as E}from"./Bs5g203e.js";import{aN as I,s as l,aG as g}from"#entry";const N=()=>{const o=h(),{post:a,get:n}=E(),s=I(),u=async r=>{try{const e=await a("/auth/login",r);if(e.code==200)o.setAuth(e.data?.token,e.data.user),g("/admin/dashboard");else throw new Error(e.message||$t("INVALID CREDENTIAL"))}catch(e){throw console.error(e),new Error($t("INVALID CREDENTIAL"))}},c=async()=>{try{const r=await n("/auth/me");if(r.code==200)return r;throw(void 0).logout(),new Error(r.message||$t("INVALID CREDENTIAL"))}catch(r){throw console.error(r),(void 0).logout(),new Error($t("INVALID CREDENTIAL"))}},d=async r=>{try{const e=new FormData;e.append("flowname","modifusertheme"),e.append("menu","admin"),e.append("search","true"),e.append("themeid",r),e.append("useraccessid",o.user?.userid),e.append("languageid",o.user?.languageid);const t=await a("admin/execute-flow",e);if(t.code==200)return o.setAuth(o.token,{...o.user,themeid:r}),t;throw new Error(t.message||$t("INVALID CREDENTIAL"))}catch(e){throw console.error(e),(void 0).logout(),new Error($t("INVALID CREDENTIAL"))}},m=async r=>{try{const e=new FormData;e.append("flowname","modifusertheme"),e.append("menu","admin"),e.append("search","true"),e.append("themeid",o.user?.themeid),e.append("useraccessid",o.user?.userid),e.append("languageid",r);const t=await a("admin/execute-flow",e);if(t.code==200)return t;throw new Error(t.message||$t("INVALID CREDENTIAL"))}catch(e){throw console.error(e),(void 0).logout(),new Error($t("INVALID CREDENTIAL"))}},i=async r=>{try{const e=new FormData;e.append("flowname","getmenubyname"),e.append("menu","admin"),e.append("search","true"),e.append("menuname",r);const t=await a("admin/execute-flow",e);if(t.code==200)return t;throw new Error(t.message||$t("INVALID CREDENTIAL"))}catch(e){throw console.error(e),new Error($t("INVALID CREDENTIAL"))}},p=async()=>{o.logout(),await s.push("/login")},w=l(()=>!!o.token);return{login:u,logout:p,updateUserTheme:d,updateUserLanguage:m,me:c,getMenuForm:i,isAuthenticated:w}};export{N as u};
