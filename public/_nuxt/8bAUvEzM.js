import{q as Ce,k as C,e as te,i as Ne,s as fe,l as we,A as le,aB as Se,H as De,c as f,o as u,h as L,a as n,t as U,E as Fe,n as ve,d as Te,aO as Oe,J as Ee,aP as Pe,F as Z,r as K,m as q,v as Q,y as ye,g as V,j as Ie,_ as Re,D as me,b as ee,B as Ue,C as je,I as ze}from"#entry";import{u as be}from"./CM07dtpo.js";import{t as Be}from"./CCayPtYg.js";import{u as Le}from"./C1IErGjn.js";import{_ as Ae}from"./CMWow-hH.js";import"./Bhw12tYx.js";import"./CD2XDZmH.js";const oe=Ce("workflow",()=>{const E=C(null),y=C([]),w=C([]),r=C([]),g=C([]),h=C([]),N=C(null),x=C([]),P=C(!1),p=be();async function D(v){P.value=!0;try{const l=new FormData;l.append("flowname","getworkflow"),l.append("menu","admin"),l.append("search","true"),l.append("workflowid",v),l.append("wfname",v);const S=(await p.post("/admin/execute-flow",l))?.data?.data??{},I=S?.flow;if(I&&typeof I=="string")try{S.flow=JSON.parse(I)}catch(ce){console.error("Failed parsing flow string",ce),S.flow=null}E.value=S;const R=new FormData;R.append("flowname","searchcombocomponentcategory"),R.append("menu","admin"),R.append("search","true");const k=await p.post("/admin/execute-flow",R);y.value=k.data?.data??[];const B=new FormData;B.append("flowname","searchcombocomponent"),B.append("menu","admin"),B.append("search","true");const F=await p.post("/admin/execute-flow",B);w.value=F.data?.data??[];const H=new FormData;H.append("flowname","searchwfparameter"),H.append("menu","admin"),H.append("search","true"),H.append("wfname",v);const de=await p.post("/admin/execute-flow",H);x.value=de.data?.data??[];const J=new FormData;J.append("flowname","searchcomponentdetails"),J.append("menu","admin"),J.append("search","true");const ie=await p.post("/admin/execute-flow",J);g.value=ie.data?.data??[];const M=new FormData;M.append("flowname","searchwfdetailbywfname"),M.append("menu","admin"),M.append("search","true"),M.append("wfname",v);const ne=await p.post("/admin/execute-flow",M);r.value=ne.data?.data??[]}finally{P.value=!1}}function T(v){return w.value.find(l=>l.code===v||l.componentname===v||l.name===v)}async function _(v,l){const m=g.value.filter(k=>k.componentname===v),S=r.value.filter(k=>k.componentname===v&&Number(k.nodeid)===Number(l)),I=new Map;S.forEach(k=>{I.set(k.componentdetailid||k.inputname,k)});const R=m.map(k=>{const B=k.componentdetailid||k.inputname,F=I.get(B);return{...k,workflowdetailid:F?.workflowdetailid??0,workflowid:F?.workflowid??0,componentvalue:F?.componentvalue??""}});return h.value=R,R}function b(v,l){return g.value.find(m=>m.componentname===v&&m.inputname===l)||null}function a(v,l,m){return r.value.find(S=>S.componentid===v&&S.componentdetailid===l&&Number(S.nodeid)===Number(m))?.workflowdetailid??""}async function d(v){const l=v?.drawflow?.Home?.data??{};for(const m of Object.values(l)){const S=m?.name,I=m?.data??{};for(const R of Object.keys(I)){const k=b(S,R);if(!k){console.warn("Meta not found:",S,R);continue}const B=a(k.componentid,k.componentdetailid,m.id),F=new FormData;F.append("flowname","modifworkflowdetail"),F.append("menu","admin"),F.append("search","false"),F.append("workflowid",E.value?.workflowid??""),F.append("componentid",k.componentid),F.append("componentdetailid",k.componentdetailid),F.append("workflowdetailid",B||""),F.append("componentvalue",I[R]),F.append("nodeid",m.id),await p.post("/admin/execute-flow",F)}}}async function s(){for(let v=0;v<x.value.length;v++){const l=x.value[v],m=new FormData;m.append("flowname","modifwfparameter"),m.append("menu","admin"),m.append("search","false"),m.append("workflowid",E.value?.workflowid??""),m.append("wfparameterid",l.wfparameterid??""),m.append("parametername",l.parametername??""),m.append("parametervalue",l.parametervalue??""),m.append("parametertype",l.parametertype??""),await p.post("/admin/execute-flow",m)}}async function c(v){P.value=!0;try{const l=new FormData;l.append("flowname","saveflow"),l.append("menu","admin"),l.append("search","false"),l.append("workflowid",E.value?.workflowid??""),l.append("flow",JSON.stringify(v));const m=await p.post("/admin/execute-flow",l);return await d(v),await s(),await D(E.value?.wfname),m}finally{P.value=!1}}function j(v){N.value=v}function X(v){if(!N.value)return;const l=window.editor;if(!l)return;const m=l.drawflow?.drawflow?.Home?.data;if(!m)return;const S=Object.keys(m).find(I=>Number(m[I].id)===Number(N.value.id));S&&(m[S].data={...m[S].data||{},...v},l.drawflow.drawflow.Home.data=m,c(l.export()))}return{workflow:E,categories:y,components:w,componentProperties:h,selectedNode:N,parameters:x,loading:P,loadWorkflow:D,findComponentByName:T,loadComponentProperties:_,saveFlow:c,setSelectedNode:j,updateSelectedNodeData:X}}),qe={class:"relative h-full"},He={key:0,id:"payload-overlay",class:"absolute top-6 left-6 p-3 bg-white shadow-lg rounded border z-50 max-w-sm"},Me={class:"flex justify-between items-center mb-2"},Ve={class:"text-xs whitespace-pre-wrap bg-gray-50 p-2 rounded max-h-40 overflow-auto"},Je={key:1,class:"absolute inset-0 z-[60] flex items-center justify-center bg-black/50"},We={class:"bg-white p-6 rounded shadow-xl w-96"},Ze={class:"mb-4"},Ke={key:0,class:"mb-4"},Xe={class:"flex justify-between text-xs mb-1"},Ge={class:"w-full bg-gray-200 rounded-full h-2.5"},Ye={key:1,class:"mb-4 text-red-500 text-sm"},Qe={class:"flex justify-end gap-2"},et=["disabled"],tt={class:"absolute right-6 top-6 flex flex-row gap-2 z-50"},ot=te({__name:"Designer",setup(E){const{t:y}=Ne(),w=oe(),r=Le(),g=C(""),h=C(""),N=C(!1),x=C([]),P=fe(()=>x.value.length>0),p=C(!1),D=C(null),T=C(-1),_=C(""),b=C(""),a=C(!1);let d=null,s=null;function c(o){const{$drawflow:e}=Oe();if(!e)return console.error("❌ Drawflow plugin not available"),null;const t=new e(o);return t.reroute=!0,t.reroute_fix_curvature=!0,t.force_first_input=!1,t.start(),t.on("nodeCreated",()=>j()),t.on("nodeRemoved",()=>j()),t.on("connectionCreated",()=>j()),t.on("connectionRemoved",()=>j()),t.on("nodeSelected",async i=>{const $=i.replace("node-",""),O=t.drawflow.drawflow?.Home?.data?.[$];O&&(await w.loadComponentProperties(O.name,$.toString()),w.setSelectedNode(O)),ce($)}),t}function j(){s&&clearTimeout(s),s=setTimeout(()=>{try{w.saveFlow(d.export())}catch(o){console.error("❌ saveFlow error",o)}},500)}async function X(){try{const o=await w.saveFlow(d.export());o.code==200&&r.add({title:y("TITLE UPDATE"),description:y(o.message.replaceAll("_"," "))})}catch(o){console.error("❌ saveFlow error",o)}}function v(o){const e=o.target;e.files&&e.files.length>0&&(D.value=e.files[0],b.value="")}function l(){p.value=!1,D.value=null,T.value=-1,_.value="",b.value="",a.value=!1}async function m(){if(!D.value)return;a.value=!0,T.value=0,_.value="Starting upload...",b.value="";const o=new FormData;o.append("plugin",D.value);try{const e=new XMLHttpRequest;e.upload.addEventListener("progress",O=>{if(O.lengthComputable){const A=Math.round(O.loaded/O.total*100);T.value=A,_.value=`Uploading... ${A}%`}}),e.addEventListener("load",()=>{if(e.status>=200&&e.status<300){T.value=100,_.value="Upload complete! Processing...";try{const O=JSON.parse(e.responseText);r.add({title:"Success",description:"Plugin uploaded successfully",color:"green"}),w.loadComponents(),setTimeout(()=>{l()},1e3)}catch{b.value="Invalid response from server"}}else b.value=`Upload failed: ${e.statusText||"Unknown error"}`;a.value=!1}),e.addEventListener("error",()=>{b.value="Network error during upload",a.value=!1});const i=Ee().public.apiBase||"/api";e.open("POST",`${i}/plugins/upload`);const $=Pe("token");$.value&&e.setRequestHeader("Authorization",`Bearer ${$.value}`),e.send(o)}catch(e){console.error("Upload error:",e),b.value=`Exception: ${e}`,a.value=!1}}we(async()=>{const o=document.getElementById("drawflow");if(!o){console.error("❌ drawflow element not found");return}d=c(o),window.editor=d;const e=w.workflow?.flow;if(e&&d)try{d.import(e),setTimeout(()=>S(),100)}catch(t){console.error("❌ ERROR IMPORT DRAWFLOW",t)}}),le(()=>w.workflow,o=>{if(!(!o||!o.flow||!d))try{const e=typeof o.flow=="string"?JSON.parse(o.flow):o.flow;d.import(e.drawflow?e:e.flow),setTimeout(()=>S(),100)}catch(e){console.error("❌ Failed to import workflow",e)}},{immediate:!0});function S(){if(!d)return;const o=document.querySelectorAll(".drawflow-node .title-box");o.forEach(e=>{const t=e.closest(".drawflow-node");if(!t)return;const i=t.id?.replace("node-","");if(!i)return;const $=d.drawflow.drawflow?.Home?.data?.[i];if(!$)return;const O=e.textContent||$.name||"Unknown",A=w.components.find(se=>(se.componentname||se.name)?.toLowerCase()===$.name?.toLowerCase()),G=`
      <div class="node-icon-wrapper">
        <div class="node-icon">
          <i class="${A?.componentclass||A?.icon||"fa-solid fa-cube"}"></i>
        </div>
        <div class="node-label">${O}</div>
      </div>
    `,z=t.querySelector(".drawflow_content_node");z&&(z.innerHTML=G)}),console.log(`✅ Converted ${o.length} old nodes to icon style`)}Se(()=>{try{d?.destroy()}catch(o){console.error(o)}});function I(){d?.zoom_in()}function R(){d?.zoom_out()}function k(){d?.zoom_reset()}function B(o){if(o.preventDefault(),!d)return;const e=o.dataTransfer?.getData("node");if(!e){console.warn("⚠️ drop: no data received");return}const t=JSON.parse(e),i=document.getElementById("drawflow").getBoundingClientRect(),$=o.clientX-i.left,O=o.clientY-i.top,A=t.componentclass||t.icon||"fa-solid fa-cube",ae=t.componenttitle??t.label??t.name,G=`
    <div class="node-icon-wrapper">
      <div class="node-icon">
        <i class="${A}"></i>
      </div>
      <div class="node-label">${ae}</div>
    </div>
  `;d.addNode(t.componentname??t.name??t.code,t.input??t.inputs??1,t.output??t.outputs??1,$,O,t.componentname??t.name,{},G),j()}function F(o){o.querySelectorAll("*").forEach(t=>{const i=window.getComputedStyle(t);i.color.includes("oklch")&&(t.style.color="#222"),i.backgroundColor.includes("oklch")&&(t.style.backgroundColor="#fff"),i.borderColor.includes("oklch")&&(t.style.borderColor="#ccc")})}async function H(){const o=document.getElementById("drawflow");if(!o)return;F(o);const e=await Be(o,{cacheBust:!0,pixelRatio:2}),t=document.createElement("a");t.download="workflow.png",t.href=e,t.click()}const de=De(),J=be();function ie(o){const e={};for(const[t,i]of o.entries())e[t]=i instanceof File?i.name:i;return e}function M(o){ne();const e=document.getElementById("drawflow");if(!e)return;const t=e.querySelector(".drawflow");t&&o.forEach(i=>{const $=document.getElementById(`node-${i.nodeId}`);if(!$)return;$.getBoundingClientRect(),t.getBoundingClientRect();const O=$.offsetLeft,A=$.offsetTop,ae=$.offsetWidth,G=$.offsetHeight,z=document.createElement("div");z.className="node-result-panel",z.setAttribute("data-node-result",i.nodeId);const se=i.success?"#dcfce7":"#fee2e2",he=i.success?"#22c55e":"#ef4444",xe=i.success?"✓":"✗",_e=i.success?"#16a34a":"#dc2626",ke=Math.max(ae,80);z.style.cssText=`
      position: absolute;
      left: ${O}px;
      top: ${A+G+4}px;
      min-width: ${ke}px;
      background: ${se};
      border: 1px solid ${he};
      border-radius: 6px;
      padding: 8px 10px;
      font-size: 12px;
      z-index: 10;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      pointer-events: auto;
      resize: both;
      overflow: auto;
    `;const Y=document.createElement("div");Y.className="result-summary",Y.style.cssText="display: flex; align-items: center; justify-content: space-between;",Y.innerHTML=`
      <span style="color: ${_e}; font-weight: bold; font-size: 14px;">${xe}</span>
      <span style="margin-left: 8px; flex: 1; color: #374151; font-size: 12px;">${i.executionTime}ms</span>
      <span style="color: #6b7280; font-size: 12px;">▼</span>
    `;const W=document.createElement("div");W.className="result-details",W.style.cssText="display: none; margin-top: 8px; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 8px;";let re="";i.input&&Object.keys(i.input).length>0&&(re+=`<div style="margin-bottom: 8px;"><strong style="font-size: 12px;">Input:</strong><pre style="background: white; padding: 8px; border-radius: 4px; margin: 4px 0; overflow: auto; max-height: 150px; font-size: 11px; white-space: pre-wrap; word-break: break-all;">${JSON.stringify(i.input,null,2)}</pre></div>`),re+=`<div><strong style="font-size: 12px;">Result:</strong><pre style="background: white; padding: 8px; border-radius: 4px; margin: 4px 0; overflow: auto; max-height: 200px; font-size: 11px; white-space: pre-wrap; word-break: break-all;">${JSON.stringify(i.result,null,2)}</pre></div>`,i.error&&(re+=`<div style="color: #dc2626; margin-top: 6px; font-size: 12px;"><strong>Error:</strong> ${i.error}</div>`),W.innerHTML=re,z.addEventListener("click",$e=>{$e.stopPropagation();const ue=W.style.display!=="none";W.style.display=ue?"none":"block",Y.querySelector("span:last-child").textContent=ue?"▼":"▲",ue||(z.style.minWidth="250px")}),z.appendChild(Y),z.appendChild(W),t.appendChild(z)})}function ne(){document.querySelectorAll(".node-result-panel").forEach(e=>e.remove())}function ce(o){const e=document.querySelector(`.node-result-panel[data-node-result="${o}"]`);if(!e)return;const t=e.querySelector(".result-details"),i=e.querySelector(".result-summary");if(t&&t.style.display!=="none"){t.style.display="none";const $=i?.querySelector("span:last-child");$&&($.textContent="▼"),e.style.minWidth="80px"}}function pe(){x.value=[],g.value="",h.value="",N.value=!1,ne()}async function ge(){try{pe();const o=new FormData;o.append("flowname",de.params.slug),o.append("menu","admin"),o.append("search","true"),o.append("debug","true");for(let t=0;t<w.parameters.length;t++){const i=w.parameters[t];o.append(i.parametername,i.parametervalue)}const e=await J.post("admin/execute-flow",o);h.value=JSON.stringify(ie(o),null,2),N.value=!0,e?.code==200?e.data?.stepResults&&Array.isArray(e.data.stepResults)?(x.value=e.data.stepResults,M(e.data.stepResults),r.add({title:"Test Complete",description:`${e.data.stepResults.length} steps executed`,color:"green"})):g.value=JSON.stringify(e.data??e.message,null,2):(g.value=`Error: ${e.message}`,r.add({title:"Test Failed",description:e.message,color:"red"}))}catch(o){g.value=`Exception: ${o}`,r.add({title:"Test Error",description:String(o),color:"red"})}}return(o,e)=>(u(),f("div",qe,[N.value?(u(),f("div",He,[n("div",Me,[e[3]||(e[3]=n("h3",{class:"font-bold text-sm"},"Test Payload",-1)),n("button",{onClick:e[0]||(e[0]=t=>N.value=!1),class:"text-gray-400 hover:text-gray-600"},"×")]),n("pre",Ve,U(h.value),1)])):L("",!0),p.value?(u(),f("div",Je,[n("div",We,[e[5]||(e[5]=n("h3",{class:"text-lg font-bold mb-4"},"Upload Component Plugin",-1)),n("div",Ze,[e[4]||(e[4]=n("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Select Plugin ZIP",-1)),n("input",{type:"file",accept:".zip",onChange:v,class:"w-full border rounded p-2 text-sm"},null,32)]),T.value>=0?(u(),f("div",Ke,[n("div",Xe,[n("span",null,U(_.value),1),n("span",null,U(T.value)+"%",1)]),n("div",Ge,[n("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:Fe({width:T.value+"%"})},null,4)])])):L("",!0),b.value?(u(),f("div",Ye,U(b.value),1)):L("",!0),n("div",Qe,[n("button",{onClick:l,class:"px-3 py-1.5 text-gray-600 hover:bg-gray-100 rounded"},"Cancel"),n("button",{onClick:m,disabled:!D.value||a.value,class:"px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},U(a.value?"Uploading...":"Upload"),9,et)])])])):L("",!0),n("div",{id:"drawflow",class:"absolute inset-0",onDrop:B,onDragover:e[1]||(e[1]=ve(()=>{},["prevent"]))},null,32),n("div",tt,[n("button",{onClick:R,class:"p-2 rounded shadow bg-white text-black",title:"Zoom Out"},"-"),n("button",{onClick:k,class:"p-2 rounded shadow bg-white text-black",title:"Reset Zoom"},"Reset"),n("button",{onClick:I,class:"p-2 rounded shadow bg-white text-black",title:"Zoom In"},"+"),e[7]||(e[7]=n("div",{class:"w-px bg-gray-300 mx-1"},null,-1)),n("button",{onClick:e[2]||(e[2]=t=>p.value=!0),class:"p-2 rounded shadow bg-white text-black flex items-center gap-1"},[...e[6]||(e[6]=[n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),n("polyline",{points:"17 8 12 3 7 8"}),n("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1),Te(" Upload Plugin ",-1)])]),n("button",{onClick:X,class:"p-2 rounded shadow bg-white text-black"},"Save"),n("button",{onClick:H,class:"p-2 rounded shadow bg-white text-black"},"Export PNG"),n("button",{onClick:ge,class:"p-2 rounded shadow bg-white text-black"},"Test Flow"),P.value?(u(),f("button",{key:0,onClick:pe,class:"p-2 rounded shadow bg-red-100 text-red-600 hover:bg-red-200"},"Clear Results")):L("",!0)])]))}}),nt=Object.assign(ot,{__name:"Designer"}),at=["onUpdate:modelValue"],st=["onUpdate:modelValue"],rt=["onUpdate:modelValue","onChange"],lt=["onClick"],dt=te({__name:"FlowParameter",setup(E){const y=oe();function w(){y.parameters.push({wfparameterid:"",parametername:"",parametervalue:"",parametertype:"string"})}function r(h){y.parameters=y.parameters.filter(N=>N.wfparameterid!==h)}function g(h){if(h.type==="number"&&(h.value=Number(h.value)||0),h.type==="boolean"&&(h.value=h.value==="true"),h.type==="json")try{h.value=JSON.stringify(JSON.parse(h.value),null,2)}catch{h.value="{}"}}return(h,N)=>(u(),f("div",null,[N[1]||(N[1]=n("h3",{class:"font-semibold mb-3"},"Flow Parameters",-1)),n("button",{onClick:w,class:"px-3 py-1 bg-blue-500 text-white rounded mb-3"},"Add Parameter"),(u(!0),f(Z,null,K(V(y).parameters,(x,P)=>(u(),f("div",{key:x.wfparameterid??P,class:"flex items-center gap-2 mb-2"},[q(n("input",{"onUpdate:modelValue":p=>x.parametername=p,placeholder:"param name (e.g. search)",class:"border p-2 rounded flex-1"},null,8,at),[[Q,x.parametername]]),q(n("input",{"onUpdate:modelValue":p=>x.parametervalue=p,placeholder:"value",class:"border p-2 rounded flex-1"},null,8,st),[[Q,x.parametervalue]]),q(n("select",{"onUpdate:modelValue":p=>x.parametertype=p,class:"border p-2 rounded w-32",onChange:p=>g(x)},[...N[0]||(N[0]=[n("option",{value:"string"},"string",-1),n("option",{value:"number"},"number",-1),n("option",{value:"boolean"},"boolean",-1),n("option",{value:"json"},"json",-1)])],40,rt),[[ye,x.parametertype]]),n("button",{onClick:p=>r(x.wfparameterid),class:"text-red-500 font-bold hover:text-red-700"},"✕",8,lt)]))),128))]))}}),it=Object.assign(dt,{__name:"FlowParameter"}),ct={class:"space-y-4"},ut={class:"flex items-center justify-between"},pt={class:"text-lg font-semibold"},mt={key:0,class:"text-sm text-gray-500"},ft={class:"block text-sm font-medium text-gray-700"},wt=["onUpdate:modelValue","placeholder","onInput"],vt=["onUpdate:modelValue","placeholder","onInput"],yt=["onUpdate:modelValue","onChange"],bt={key:0,value:""},gt=["value"],ht=["onUpdate:modelValue","onInput"],xt={key:4,class:"text-xs text-gray-400"},_t=te({__name:"PropertyForm",props:{componentName:{type:String,required:!1},nodeId:{type:[String,Number],required:!1}},setup(E){const y=E,w=oe(),r=Ie({}),g=C([]);function h(a,d=500){let s=null;return function(...c){clearTimeout(s),s=setTimeout(()=>a.apply(this,c),d)}}function N(a){return(a.inputtype??"").toLowerCase()==="textbox"}function x(a){return(a.inputtype??"").toLowerCase()==="textarea"}function P(a){return(a.inputtype??"").toLowerCase()==="combobox"||(a.inputtype??"").toLowerCase()==="select"}function p(a){const d=a.datasource;return!!(d&&d.length)}function D(a){return a?a.datasourcetype&&a.datasourcetype.toLowerCase()==="list"&&a.datasource?a.datasource.split(",").map(d=>d.trim()):Array.isArray(a.datasource)?a.datasource:[]:[]}function T(){g.value.sort((s,c)=>(Number(s.order)||0)-(Number(c.order)||0));let a={};const d=window.editor;if(d){const s=d.drawflow?.drawflow?.Home?.data,c=w.selectedNode;if(s&&c){const j=Object.keys(s).find(X=>Number(s[X].id)===Number(c.id));j&&s[j]?.data&&(a=s[j].data)}}g.value.forEach(s=>{const c=s.inputname;a&&Object.prototype.hasOwnProperty.call(a,c)?r[c]=a[c]:r[c]=s.componentvalue??""})}const _=h(()=>{const a={};g.value.forEach(d=>{a[d.inputname]=r[d.inputname]}),w.updateSelectedNodeData(a)},500);function b(a){_()}return le([()=>y.componentName,()=>y.nodeId],async([a,d])=>{if(!a){g.value=[],Object.keys(r).forEach(c=>delete r[c]);return}const s=await w.loadComponentProperties(a,d);g.value=s,T()},{immediate:!0}),le(()=>w.selectedNode,a=>{a&&T()},{deep:!0}),(a,d)=>(u(),f("div",ct,[n("div",ut,[n("h3",pt,U(E.componentName??"Properties"),1)]),g.value.length===0?(u(),f("div",mt,"No properties available for this component.")):(u(),f("form",{key:1,class:"space-y-3",onSubmit:d[0]||(d[0]=ve(()=>{},["prevent"]))},[(u(!0),f(Z,null,K(g.value,s=>(u(),f("div",{key:s.componentdetailid,class:"space-y-1"},[n("label",ft,U(s.lable??s.inputname),1),N(s)?q((u(),f("input",{key:0,"onUpdate:modelValue":c=>r[s.inputname]=c,placeholder:s.inputdesc||"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-300",onInput:c=>b()},null,40,wt)),[[Q,r[s.inputname]]]):x(s)?q((u(),f("textarea",{key:1,"onUpdate:modelValue":c=>r[s.inputname]=c,placeholder:s.inputdesc||"",rows:"4",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-300",onInput:c=>b()},null,40,vt)),[[Q,r[s.inputname]]]):P(s)?q((u(),f("select",{key:2,"onUpdate:modelValue":c=>r[s.inputname]=c,class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-300",onChange:c=>b()},[p(s)?L("",!0):(u(),f("option",bt,"-- select --")),(u(!0),f(Z,null,K(D(s),c=>(u(),f("option",{key:c,value:c},U(c),9,gt))),128))],40,yt)),[[ye,r[s.inputname]]]):q((u(),f("input",{key:3,"onUpdate:modelValue":c=>r[s.inputname]=c,class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-300",onInput:c=>b()},null,40,ht)),[[Q,r[s.inputname]]]),s.inputdesc?(u(),f("p",xt,U(s.inputdesc),1)):L("",!0)]))),128))],32))]))}}),kt=Object.assign(Re(_t,[["__scopeId","data-v-29511cde"]]),{__name:"PropertyForm"}),$t={class:"h-full flex flex-row bg-white text-gray-900 shadow-sm border-r"},Ct={class:"panel w-12 flex flex-col items-center py-2 border-r border-gray-700 z-20"},Nt=["onClick","title"],St={class:"w-80 flex flex-col bg-gray-50 border-r transition-all duration-300 ease-in-out"},Dt={class:"p-3 border-b bg-gray-100 flex justify-between items-center"},Ft={class:"font-semibold text-sm uppercase text-gray-600"},Tt={class:"flex-1 overflow-auto p-3"},Ot={key:0},Et={class:"font-semibold text-xs text-gray-500 uppercase mb-2 tracking-wider"},Pt=["onDragstart"],It={class:"truncate"},Rt={key:1},Ut={key:2},jt={key:1,class:"text-gray-500 text-sm italic text-center mt-10"},zt=te({__name:"WorkflowSidebar",setup(E){const y=oe(),w=C("toolbox"),r=C(!0),g=[{id:"toolbox",label:"Toolbox",icon:"heroicons:squares-2x2"},{id:"parameter",label:"Parameters",icon:"heroicons:variable"},{id:"property",label:"Properties",icon:"heroicons:cog-6-tooth"}],h=fe(()=>g.find(p=>p.id===w.value)?.label||"");function N(p){w.value===p?r.value=!r.value:(w.value=p,r.value=!0)}function x(p){return y.components.filter(D=>D?D.categoryname===p.categoryname:!1)}function P(p,D){p.dataTransfer?.setData("node",JSON.stringify(D))}return(p,D)=>{const T=Ae;return u(),f("div",$t,[n("div",Ct,[(u(),f(Z,null,K(g,_=>n("button",{key:_.id,class:me(["p-3 mb-2 rounded hover:text-white transition-colors relative",{"text-white border-l-2 border-white bg-gray-700":w.value===_.id&&r.value}]),onClick:b=>N(_.id),title:_.label},[ee(T,{name:_.icon,class:"w-6 h-6"},null,8,["name"])],10,Nt)),64))]),q(n("div",St,[n("div",Dt,[n("span",Ft,U(h.value),1),n("button",{onClick:D[0]||(D[0]=_=>r.value=!1),class:"text-gray-500 hover:text-gray-700"},[ee(T,{name:"heroicons:x-mark",class:"w-4 h-4"})])]),n("div",Tt,[w.value==="toolbox"?(u(),f("div",Ot,[(u(!0),f(Z,null,K(V(y).categories,_=>(u(),f("div",{key:_.id,class:"mb-4"},[n("div",Et,U(_.categoryname??_.label??_.name),1),n("div",null,[(u(!0),f(Z,null,K(x(_),b=>(u(),f("div",{key:b.componentname??b.code??b.name,draggable:"true",onDragstart:a=>P(a,b),class:"p-2 bg-white border rounded mb-1 cursor-grab flex items-center gap-2 hover:border-blue-400 hover:shadow-sm transition-all text-sm"},[n("i",{class:me([b.componentclass??b.icon,"text-gray-600"])},null,2),n("span",It,U(b.componenttitle??b.label??b.name),1)],40,Pt))),128))])]))),128))])):L("",!0),w.value==="parameter"?(u(),f("div",Rt,[ee(it)])):L("",!0),w.value==="property"?(u(),f("div",Ut,[V(y).selectedNode?(u(),je(kt,{key:0,componentName:V(y).selectedNode.name,nodeId:V(y).selectedNode.nodeid??V(y).selectedNode.id??V(y).selectedNode.data?.nodeid},null,8,["componentName","nodeId"])):(u(),f("div",jt,"Select a node to edit properties"))])):L("",!0)])],512),[[Ue,r.value]])])}}}),Bt=Object.assign(zt,{__name:"WorkflowSidebar"}),Lt={class:"h-screen flex overflow-hidden"},At={class:"flex-none bg-white border-r z-10"},qt={class:"flex-1 relative bg-gray-100"},Xt=te({__name:"[...slug]",setup(E){const y=ze(),w=oe();return we(async()=>{const r=y.params.slug??y.params.id??y.query.id;r&&await w.loadWorkflow(r)}),le(()=>y.params.slug,async r=>{const g=r??y.params.id??y.query.id;g&&await w.loadWorkflow(g)}),(r,g)=>(u(),f("div",Lt,[n("div",At,[ee(Bt)]),n("div",qt,[ee(nt)])]))}});export{Xt as default};
