import{_ as U}from"./CGyzmy_M.js";import{y as T,r as b,a as V,B as u,ak as l,a_ as o,b0 as E,Y as D,ay as J,b5 as A,an as f,am as h,b7 as W,b8 as L,aN as C,u as y,d as q,z as Y,w as G,aj as H,aF as O,al as K,b1 as Q,i as X,b6 as Z}from"./DH2n3Tqk.js";import{a as ee,l as te}from"./DnqiU5Z1.js";import oe from"./BNTewa7k.js";import ae from"./Cp-22nQC.js";import re from"./CcFEbDs5.js";import{M as se}from"#entry";import{s as ne}from"./BXI2M5or.js";import{u as le}from"./DmmRtUIM.js";import{u as ie}from"./C1AnPZyN.js";import"./B3hjldT8.js";import"./KobTAp13.js";/* empty css        */import"./Bu8C_CX3.js";const de={class:"h-full flex flex-row bg-white text-gray-900 shadow-sm border-r"},ue={class:"panel w-12 flex flex-col items-center py-2 border-r border-gray-700 z-20"},ce=["onClick","title"],me={key:0,class:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500"},pe={class:"w-80 flex flex-col bg-gray-50 border-r transition-all duration-300 ease-in-out"},ge={class:"p-3 border-b bg-gray-100 flex justify-between items-center"},ve={class:"font-semibold text-sm uppercase text-gray-600"},fe={class:"flex-1 overflow-auto p-3"},we={key:0},be=["onDragstart"],he={class:"truncate"},ye=["onDragstart"],xe={class:"truncate"},_e={key:1},ke=T({__name:"WidgetSidebar",setup(M){const v=b("elements"),m=b(!0),_=[{id:"elements",label:"Elements",icon:"heroicons:squares-plus"}],i=V(()=>_.find(r=>r.id===v.value)?.label||"");function p(r){v.value===r?m.value=!m.value:(v.value=r,m.value=!0)}function w(r,s){r.dataTransfer&&(r.dataTransfer.setData("component",JSON.stringify(s)),window.draggingComponent=s)}return(r,s)=>{const k=W;return l(),u("div",de,[o("div",ue,[(l(),u(D,null,J(_,d=>o("button",{key:d.id,class:A(["w-full relative flex justify-center py-3 mb-1 hover:bg-gray-700 transition-colors",v.value===d.id&&m.value?"text-white":"text-gray-400 hover:text-gray-200"]),onClick:x=>p(d.id),title:d.label},[v.value===d.id&&m.value?(l(),u("div",me)):f("",!0),h(k,{name:d.icon,class:"w-6 h-6"},null,8,["name"])],10,ce)),64))]),E(o("div",pe,[o("div",ge,[o("span",ve,C(i.value),1),o("button",{onClick:s[0]||(s[0]=d=>m.value=!1),class:"text-gray-500 hover:text-gray-700"},[h(k,{name:"heroicons:x-mark",class:"w-4 h-4"})])]),o("div",fe,[v.value==="elements"?(l(),u("div",we,[s[1]||(s[1]=o("h2",{class:"font-bold text-sm text-gray-700 mb-3 uppercase tracking-wider"},"Components",-1)),(l(!0),u(D,null,J(y(ee),(d,x)=>(l(),u("div",{key:x,class:"p-2 bg-white border rounded mb-1 cursor-grab flex items-center gap-2 hover:border-blue-400 hover:shadow-sm transition-all text-sm",draggable:"true",onDragstart:S=>w(S,d)},[o("span",he,C(d.label),1)],40,be))),128)),s[2]||(s[2]=o("h3",{class:"font-bold text-sm text-gray-700 mt-4 mb-3 uppercase tracking-wider"},"Containers",-1)),(l(!0),u(D,null,J(y(te),(d,x)=>(l(),u("div",{key:"grp-"+x,class:"p-2 bg-white border rounded mb-1 cursor-grab flex items-center gap-2 hover:border-blue-400 hover:shadow-sm transition-all text-sm",draggable:"true",onDragstart:S=>w(S,d)},[o("span",xe,C(d.label),1)],40,ye))),128))])):f("",!0),v.value==="structure"?(l(),u("div",_e,[...s[3]||(s[3]=[o("div",{class:"text-gray-500 text-sm italic text-center mt-10"}," Structure view is currently on the right panel. ",-1)])])):f("",!0)])],512),[[L,m.value]])])}}}),Se=Object.assign(ke,{__name:"WidgetSidebar"}),Ce={class:"flex"},De={class:"flex h-screen overflow-hidden bg-gray-100"},Ne={class:"flex-none bg-white border-r z-10"},$e={class:"flex-1 p-5 overflow-auto w-full bg-white dark:bg-black"},Je={key:0,class:"flex items-center justify-between sticky top-0 z-50 px-6 py-3 transition-colors duration-300 backdrop-blur-md"},Fe={key:0,class:"text-gray-400 text-center py-20"},Oe=["onClick"],Te={key:1,class:"panel font-mono text-sm rounded-xl p-4 overflow-auto max-h-[80vh]"},Ve={class:"w-1/4 bg-white border-l p-4 overflow-y-auto dark:bg-black"},Ee={key:0},He=T({__name:"[...slug]",setup(M){const v=se(),m=ne(),_=b(""),i=b([]),p=b(null),w=b(null),r=b(!1),s=b(!0),{getWidgetForm:k}=le(),d=ie(),x=e=>{const t=e.dataTransfer?.getData("component");if(!t)return;const g=JSON.parse(t),n={id:Math.random().toString(36).substr(2,9),...g};i.value.push(n),window.draggingComponent=null},S=([e,t])=>{const g=n=>{for(const c of n){if(c.id===e)return Array.isArray(c.children)||(c.children=[]),c.children.push(t),!0;if(c.children&&g(c.children))return!0}return!1};g(i.value)},R=e=>{if(!confirm(`Are you sure you want to delete "${e.label}"?`))return;const t=g=>{const n=g.findIndex(c=>c.id===e.id);if(n!==-1)return g.splice(n,1),!0;for(const c of g)if(c.children&&t(c.children))return!0;return!1};t(i.value),p.value=null},N=e=>{p.value=e},j=()=>{r.value=!r.value},z=()=>{s.value=!s.value},B=async()=>{i.value=[]},I=async()=>{const e=new FormData;e.append("flowname","modifwidget"),e.append("menu","admin"),e.append("search","true"),e.append("widgetid",a.widgetid),e.append("widgetname",a.widgetname),e.append("description",a.description),e.append("widgettitle",a.widgettitle),e.append("widgetversion",a.widgetversion),e.append("widgetby",a.widgetby),e.append("moduleid",a.moduleid),e.append("recordstatus",a.recordStatus),e.append("widgetform",JSON.stringify(_.value));try{const t=await d.post("admin/execute-flow",e);t?.code==200?m.add({title:"Success",description:"Runtime schema saved successfully",color:"success"}):m.add({title:"Error",description:t.message,color:"error"})}catch(t){m.add({title:"Error",description:t,color:"error"})}},a=q({widgetid:Number,widgetname:String,widgettitle:String,widgetversion:String,widgetform:String,description:String,moduleid:Number,modulename:String,widgetby:String,installdate:String,recordStatus:Number}),F=async()=>{try{const e=await k(v.params.slug);e?.code==200?(a.widgetid=e?.data.data.widgetid,a.widgetname=e?.data.data.widgetname,a.description=e?.data.data.description,a.widgettitle=e?.data.data.widgettitle,a.widgetversion=e?.data.data.widgetversion,a.moduleid=e?.data.data.moduleid,a.modulename=e?.data.data.modulename,a.widgetby=e?.data.data.widgetby,a.installdate=e?.data.data.installdate,a.recordStatus=e?.data.data.recordstatus,e?.data.data.widgetform!=""&&(w.value=e?.data?.data.widgetform,i.value=JSON.parse(e?.data?.data.widgetform))):console.error("Invalid response from ",e)}catch(e){console.error("Error loading :",e)}},P=async()=>{const e=window.prompt("Copy Schema From ? ");if(e)try{const t=await k(e);t?.code==200?t?.data.data.menuform!=""&&(w.value=t?.data?.data.menuform,i.value=t?.data?.data.menuform):console.error("Invalid response from ",t)}catch(t){console.error("Error loading :",t)}else console.warn("Empty")};Y(async()=>{F()});const $=V({get(){return JSON.stringify(i.value,null,2)},set(e){try{i.value=JSON.parse(e)}catch(t){console.error(t)}}});return G(i,e=>{_.value=e,w.value=e},{deep:!0,immediate:!0}),(e,t)=>{const g=U;return l(),u(D,null,[o("div",Ce,[o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:I}," ðŸ’¾ Save Schema "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:B}," Clear Schema "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:F}," ðŸ“‚ Load Schema "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:P}," ðŸ“‚ Copy From ... "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:j},C(r.value?"ðŸ§± Edit Mode":"ðŸ‘ Preview"),1),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:z},C(s.value?"ðŸ§± Debug Off":"ðŸ‘ Debug On"),1)]),o("div",De,[o("div",Ne,[h(Se)]),o("main",$e,[r.value?(l(),u("div",Je,[w.value?(l(),H(g,{key:0,schema:w.value,menuName:y(a).menuName,formType:y(a).menuType,title:y(a).description},null,8,["schema","menuName","formType","title"])):f("",!0)])):f("",!0),r.value?f("",!0):(l(),u("div",{key:1,class:"min-h-[80vh] rounded-xl shadow-inner",onDragover:t[2]||(t[2]=O(()=>{},["prevent"])),onDrop:x},[i.value?.length?f("",!0):(l(),u("div",Fe," Drag components or containers here ")),h(y(Z),{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),group:"components","item-key":"id",class:"space-y-3"},{item:K(({element:n})=>[o("div",{class:A(["panel border rounded p-3 cursor-pointer relative group",{"border-blue-600":p.value?.id===n.id}]),onClick:O(c=>N(n),["stop"])},[h(oe,{node:n,preview:r.value,showJson:s.value,selected:p.value,onSelect:N,onDropChild:S,onDelete:R},null,8,["node","preview","showJson","selected"])],10,Oe)]),_:1},8,["modelValue"]),s.value&&!r.value?(l(),u("div",Te,[t[4]||(t[4]=o("h1",null,"Debug",-1)),E(o("textarea",{"onUpdate:modelValue":t[1]||(t[1]=n=>X($)?$.value=n:null),class:"w-full h-120 p-3 border rounded font-mono text-sm"},null,512),[[Q,y($)]])])):f("",!0)],32))]),o("aside",Ve,[t[6]||(t[6]=o("h3",{class:"font-semibold mb-3"},"Form Structure",-1)),h(ae,{nodes:i.value,selected:p.value,onSelect:N},null,8,["nodes","selected"]),t[7]||(t[7]=o("hr",{class:"my-4"},null,-1)),p.value&&!r.value?(l(),u("div",Ee,[t[5]||(t[5]=o("h3",{class:"font-semibold mb-3"},"Properties",-1)),h(re,{modelValue:p.value.props,"onUpdate:modelValue":t[3]||(t[3]=n=>p.value.props=n)},null,8,["modelValue"])])):f("",!0)])])],64)}}});export{He as default};
