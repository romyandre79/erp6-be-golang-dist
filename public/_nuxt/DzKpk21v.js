import{n as Ae,b as H,bl as Oe,ai as Ue,_ as Ee}from"#entry";import{y as R,r as n,a as z,w as ee,B as r,ak as o,b0 as G,a_ as e,bd as ze,Y as B,ay as L,aN as i,u as x,bi as ve,am as I,an as j,T as q,al as A,b5 as C,bc as te,z as Y,N as Be,aF as P,b1 as ue,J as fe,a$ as Le,aj as ge,b8 as De,bj as We}from"./DirAx5lA.js";import{u as se}from"./Cbr8hgwd.js";import{u as ae}from"./Dq2ZLox9.js";import{u as oe}from"./CoedoqIK.js";import{u as re}from"./BJDXyoEI.js";import{u as Ve}from"./mra8fcCZ.js";/* empty css        */import"./KobTAp13.js";import"./CHaV0QvJ.js";import"./DQ_kd7ue.js";const Ze={class:"relative w-10 h-10 flex items-center justify-center cursor-pointer group navbar-icon-wrapper"},Pe=["title"],Re=["value"],Fe=R({__name:"ThemeToggle",setup(F){const u=se(),f=ae(),_=n(u.theme),$=z(()=>{const g=u.themeList.find(v=>v.themeid===_.value);return g?.description||g?.themename||"Theme"});return ee(_,g=>{f.updateUserTheme(g),u.loadSingleThemes(g),u.applyTheme(g)}),(g,v)=>(o(),r("div",Ze,[G(e("select",{"onUpdate:modelValue":v[0]||(v[0]=l=>_.value=l),class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",title:$.value},[(o(!0),r(B,null,L(x(u).themeList,l=>(o(),r("option",{key:l.themeid,value:l.themeid},i(l.description||l.themename),9,Re))),128))],8,Pe),[[ze,_.value]]),v[1]||(v[1]=e("i",{class:"fa-solid fa-palette text-lg transition-colors",style:{color:"var(--navbar-icon-color, #6b7280)"}},null,-1))]))}}),me=Object.assign(Fe,{__name:"ThemeToggle"}),Je={class:"relative"},He={key:0,class:"absolute -top-1 -right-1 min-w-[18px] h-[18px] flex items-center justify-center px-1 text-[10px] font-bold text-white bg-gradient-to-r from-rose-500 to-pink-500 rounded-full shadow-lg shadow-rose-500/30 animate-pulse"},Ge={key:0,class:"absolute right-0 mt-3 w-80 bg-white dark:bg-gray-900 rounded-2xl shadow-2xl shadow-black/10 dark:shadow-black/30 overflow-hidden z-50 border border-slate-200/80 dark:border-gray-800"},Ye={class:"px-4 py-3 bg-gradient-to-r from-slate-50 to-slate-100 dark:from-gray-800 dark:to-gray-900 border-b border-slate-200 dark:border-gray-800 flex justify-between items-center"},qe={class:"max-h-72 overflow-y-auto custom-scrollbar"},Ke={key:0,class:"p-8 text-center"},Qe=["onClick"],Xe={class:"flex gap-3"},et={class:"flex-1 min-w-0"},tt={class:"flex justify-between items-start mb-0.5"},st={class:"font-medium text-sm text-gray-800 dark:text-white truncate"},at={class:"text-[10px] text-gray-400 dark:text-gray-500 ml-2 flex-shrink-0"},ot={class:"text-xs text-gray-500 dark:text-gray-400 line-clamp-2"},rt=R({__name:"NotificationBell",setup(F){const u=re(),{unreadCount:f,notifications:_}=ve(u),$=n(!1),g=()=>$.value=!$.value,v=async l=>{await u.markAsRead(l)};return(l,c)=>(o(),r("div",Je,[e("button",{onClick:g,class:"navbar-icon relative w-10 h-10 flex items-center justify-center rounded-xl transition-all duration-200 group"},[c[1]||(c[1]=e("i",{class:"fa-solid fa-bell text-lg group-hover:scale-110 transition-transform"},null,-1)),x(f)>0?(o(),r("span",He,i(x(f)>9?"9+":x(f)),1)):j("",!0)]),I(q,{name:"dropdown"},{default:A(()=>[$.value?(o(),r("div",Ge,[e("div",Ye,[c[3]||(c[3]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-7 h-7 rounded-lg bg-indigo-100 dark:bg-indigo-900/40 flex items-center justify-center"},[e("i",{class:"fa-solid fa-bell text-indigo-500 text-xs"})]),e("h3",{class:"text-sm font-semibold text-gray-800 dark:text-white"},"Notifications")],-1)),e("button",{onClick:c[0]||(c[0]=d=>$.value=!1),class:"w-7 h-7 flex items-center justify-center rounded-lg hover:bg-slate-200 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},[...c[2]||(c[2]=[e("i",{class:"fa-solid fa-times text-xs"},null,-1)])])]),e("div",qe,[x(_).length===0?(o(),r("div",Ke,[...c[4]||(c[4]=[e("div",{class:"w-12 h-12 mx-auto mb-3 rounded-full bg-slate-100 dark:bg-gray-800 flex items-center justify-center"},[e("i",{class:"fa-solid fa-inbox text-slate-400 dark:text-gray-500"})],-1),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"No notifications yet",-1)])])):j("",!0),(o(!0),r(B,null,L(x(_),d=>(o(),r("div",{key:d.usertodoid,onClick:S=>v(d.usertodoid),class:C(["p-3 border-b border-slate-100 dark:border-gray-800 cursor-pointer transition-all duration-200","hover:bg-slate-50 dark:hover:bg-gray-800",d.isread?"opacity-60":"bg-indigo-50/50 dark:bg-indigo-900/10"])},[e("div",Xe,[e("div",{class:C(["w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0",d.isread?"bg-slate-100 dark:bg-gray-800":"bg-indigo-100 dark:bg-indigo-900/40"])},[e("i",{class:C(["fa-solid fa-circle-info text-xs",d.isread?"text-gray-400":"text-indigo-500"])},null,2)],2),e("div",et,[e("div",tt,[e("span",st,i(d.menuname),1),e("span",at,i(new Date(d.tododate).toLocaleDateString()),1)]),e("p",ot,i(d.description),1)])])],10,Qe))),128))])])):j("",!0)]),_:1})]))}}),lt=Object.assign(te(rt,[["__scopeId","data-v-7079819e"]]),{__name:"NotificationBell"}),nt={class:"flex items-center justify-between px-6 py-3 transition-colors duration-300"},it={class:"flex items-center gap-3"},dt={class:"hidden sm:block text-left"},ct={class:"text-sm font-semibold leading-tight",style:{color:"var(--navbar-admin-color, #1f2937)"}},ut={class:"text-xs",style:{color:"var(--sidebar-profile-email-color, #6b7280)"}},ft={key:0,class:"absolute right-0 mt-3 w-90 bg-white dark:bg-gray-900 rounded-2xl shadow-2xl shadow-black/10 dark:shadow-black/30 overflow-hidden z-50 border border-slate-200/80 dark:border-gray-800"},gt={class:"px-4 py-4 border-b border-slate-200 dark:border-gray-800"},vt={class:"flex items-center gap-3"},mt={class:"flex-1 min-w-0"},pt={class:"text-sm font-semibold text-gray-800 dark:text-white truncate"},xt={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},bt={class:"py-2"},ht={class:"text-sm text-gray-700 dark:text-gray-200 group-hover:text-gray-900 dark:group-hover:text-white"},yt={class:"text-sm text-gray-700 dark:text-gray-200 group-hover:text-rose-600 dark:group-hover:text-rose-400"},_t=R({__name:"NavbarAdmin",setup(F){const{logout:u}=ae(),f=oe(),_=se();f.loadAuth(),f.user?.photo;const $=f.user?.realname,g=f.user?.email;z(()=>_.theme);const v=n(!1),l=n(null),c=()=>{v.value=!v.value},d=T=>{l.value&&!l.value.contains(T.target)&&(v.value=!1)},S=async()=>{v.value=!1,await u()},M=()=>{v.value=!1,Ae("/admin/profile")};return Y(()=>document.addEventListener("click",d)),Be(()=>document.removeEventListener("click",d)),(T,b)=>(o(),r("header",nt,[b[6]||(b[6]=e("div",{class:"flex items-center gap-3"},null,-1)),e("div",it,[I(lt),I(me),b[5]||(b[5]=e("div",{class:"h-8 w-px bg-slate-200 dark:bg-gray-700 mx-1"},null,-1)),e("div",{ref_key:"userMenu",ref:l,class:"relative"},[e("button",{onClick:P(c,["stop"]),class:"profile-trigger flex items-center gap-3 cursor-pointer rounded-xl px-3 py-2 transition-all duration-200 group"},[b[0]||(b[0]=e("div",{class:"w-9 h-9 flex items-center justify-center",style:{color:"var(--sidebar-profile-icon-color, #6366f1)"}},[e("i",{class:"fa-solid fa-user-circle text-2xl"})],-1)),e("div",dt,[e("p",ct,i(x($)),1),e("p",ut,i(x(g)),1)]),e("i",{class:C(["fa-solid fa-chevron-down text-[10px] transition-transform duration-200 ml-1",{"rotate-180":v.value}]),style:{color:"var(--navbar-icon-color, #9ca3af)"}},null,2)]),I(q,{name:"dropdown"},{default:A(()=>[v.value?(o(),r("div",ft,[e("div",gt,[e("div",vt,[b[1]||(b[1]=e("div",{class:"w-10 h-10 flex items-center justify-center text-indigo-600 dark:text-indigo-400"},[e("i",{class:"fa-solid fa-user-circle text-3xl"})],-1)),e("div",mt,[e("p",pt,i(x($)),1),e("p",xt,i(x(g)),1)])])]),e("div",bt,[e("button",{onClick:P(M,["prevent"]),class:"flex items-center gap-3 w-full px-4 py-2.5 text-left transition-all duration-200 hover:bg-slate-50 dark:hover:bg-gray-800 group"},[b[2]||(b[2]=e("div",{class:"w-8 h-8 rounded-lg bg-slate-100 dark:bg-gray-800 group-hover:bg-indigo-100 dark:group-hover:bg-indigo-900/40 flex items-center justify-center transition-colors"},[e("i",{class:"fa-regular fa-user text-gray-500 group-hover:text-indigo-500 text-sm transition-colors"})],-1)),e("span",ht,i(T.$t("PROFILE")),1)]),b[4]||(b[4]=e("div",{class:"mx-3 my-1 h-px bg-slate-100 dark:bg-gray-800"},null,-1)),e("button",{onClick:P(S,["prevent"]),class:"flex items-center gap-3 w-full px-4 py-2.5 text-left transition-all duration-200 hover:bg-rose-50 dark:hover:bg-rose-900/20 group"},[b[3]||(b[3]=e("div",{class:"w-8 h-8 rounded-lg bg-slate-100 dark:bg-gray-800 group-hover:bg-rose-100 dark:group-hover:bg-rose-900/40 flex items-center justify-center transition-colors"},[e("i",{class:"fa-solid fa-right-from-bracket text-gray-500 group-hover:text-rose-500 text-sm transition-colors"})],-1)),e("span",yt,i(T.$t("LOGOUT")),1)])])])):j("",!0)]),_:1})],512)])]))}}),wt=Object.assign(te(_t,[["__scopeId","data-v-1deec9d7"]]),{__name:"NavbarAdmin"}),kt={class:"fixed bottom-6 right-6 z-50 flex flex-col items-end"},Ct={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center animate-pulse"},$t={key:1},St={key:2},jt={key:0,class:"fixed bottom-24 right-6 z-50 bg-white dark:bg-gray-800 shadow-2xl rounded-2xl w-80 sm:w-96 flex flex-col overflow-hidden border border-gray-200 dark:border-gray-700 h-[600px]"},Tt={class:"bg-gray-100 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 flex"},It={key:0,class:"flex-1 flex flex-col min-h-0"},Nt={class:"p-3 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700"},Mt={key:1,class:"flex-1 flex flex-col min-h-0"},At={key:0,class:"flex-1 overflow-y-auto p-2 space-y-1"},Ot={key:0,class:"text-center p-4 text-gray-500"},Ut={key:1,class:"text-center p-4 text-gray-500"},Et=["onClick"],zt={class:"relative"},Bt=["src"],Lt={key:0,class:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full"},Dt={class:"flex-1 min-w-0"},Wt={class:"font-semibold text-gray-900 dark:text-white truncate"},Vt={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},Zt={key:0,class:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center"},Pt={key:1,class:"flex-1 flex flex-col min-h-0 bg-gray-50 dark:bg-gray-900"},Rt={class:"bg-white dark:bg-gray-800 p-3 flex items-center gap-3 shadow-sm z-10"},Ft={class:"flex items-center gap-2 flex-1"},Jt={class:"relative"},Ht=["src"],Gt={key:0,class:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"},Yt={class:"font-semibold text-sm"},qt={class:"text-[10px] opacity-70 mt-1 text-right"},Kt={class:"p-3 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700"},Qt={key:0,class:"fixed bottom-24 right-[400px] z-50 w-80 bg-black rounded-2xl overflow-hidden shadow-2xl border-2 border-gray-800 flex flex-col"},Xt={class:"relative h-60 bg-gray-900"},es={class:"absolute bottom-4 right-4 w-24 h-32 bg-gray-800 rounded-lg overflow-hidden border border-gray-600 shadow-lg"},ts={class:"absolute top-4 left-4 text-white text-xs bg-black/50 px-2 py-1 rounded"},ss={key:1,class:"fixed top-6 right-6 z-50 bg-white dark:bg-gray-800 p-4 rounded-xl shadow-2xl border-l-4 border-green-500 w-72 animate-bounce-in"},as={class:"flex items-center gap-3 mb-4"},os={class:"text-sm text-gray-500"},rs=R({__name:"AiAssistant",setup(F){const u=n(!1),f=n("ai"),_=n(""),$=n([]),g=n([]),v=n(!1),l=n(null),c=n(""),d=n({}),S=n({}),M=oe(),T=z(()=>M.user?.userid),b=z(()=>Object.values(S.value).reduce((s,t)=>s+t,0)),O=n(null),D=n(null);re();const{get:J,post:m}=Ve(),h=n(!1),U=n(null),V=n(null),k=n(null),N=n(null),E=n("Connecting..."),p=n(null),{token:W}=ve(M),K=z(()=>M.token);let y=null;const pe=()=>{u.value=!u.value,u.value&&f.value==="people"&&g.value.length===0&&le()};ee(f,s=>{s==="people"&&g.value.length===0&&le()});const Z=async s=>{await fe(),s&&(s.scrollTop=s.scrollHeight)},xe=async()=>{if(!_.value.trim())return;const s=_.value;$.value.push({text:s,sender:"user"}),_.value="",await Z(O.value);try{const{data:t}=await m("/admin/ai/command",{message:s}),a=t?.reply||t?.data?.reply||"Done";$.value.push({text:a,sender:"ai"})}catch{$.value.push({text:"Error connecting to AI.",sender:"ai"})}await Z(O.value)},le=async()=>{v.value=!0;try{const{data:s}=await J("/admin/users/list");g.value=s||[],g.value.forEach(t=>{S.value[t.useraccessid]||(S.value[t.useraccessid]=0)})}catch(s){console.error(s)}finally{v.value=!1}},be=s=>{l.value=s,s&&S.value[s.useraccessid]&&(S.value[s.useraccessid]=0),he(s.useraccessid),fe(()=>Z(D.value))},he=async s=>{try{const{data:t}=await J(`/admin/chat/history?target_id=${s}`);t&&(d.value[s]=t.map(a=>({text:a.message,senderId:a.sender_id,timestamp:a.created_at})))}catch(t){console.error("Failed to load history",t)}},ne=s=>{const t=H();if(s&&s.userphoto){if(s.userphoto.startsWith("http"))return s.userphoto;const a=s.userphoto.replace(/^\//,"");return`${t.public.apiBase}/useraccess/${a}`}return`${t.public.apiBase}/useraccess/admin.png`},ie=s=>{const t=s.target,a=H();t.src=`${a.public.apiBase}/useraccess/admin.png`},ye=()=>{if(y&&(y.readyState===WebSocket.OPEN||y.readyState===WebSocket.CONNECTING))return;const s=H();if(!K.value){console.error("No token for WS");return}y&&y.close();const a=`${s.public.apiBase.replace("http","ws")}/ws/notifications?token=${K.value}`;console.log("Connecting to Chat WS:",a),y=new WebSocket(a),y.onopen=()=>{console.log("Chat WS Connected")},y.onmessage=async w=>{try{const X=JSON.parse(w.data);_e(X)}catch(X){console.error("WS Message Parse Error",X)}},y.onclose=w=>{console.log("Chat WS Closed",w.code,w.reason),y=null},y.onerror=w=>{console.error("Chat WS Error",w)}};Y(()=>{ee(()=>K.value,s=>{s?ye():(y&&y.close(),y=null)},{immediate:!0})});const _e=async s=>{if(console.log("WS Msg:",s),s.type==="chat"){const t=s.sender_id;d.value[t]||(d.value[t]=[]),d.value[t].push({text:s.data.text,senderId:t,timestamp:s.data.timestamp||new Date().toISOString()}),l.value&&l.value.useraccessid===t&&u.value&&f.value==="people"?await Z(D.value):(S.value[t]||(S.value[t]=0),S.value[t]++)}else s.type==="offer"?Se(s):s.type==="answer"?Ie(s):s.type==="candidate"&&Ne(s)},we=()=>{if(!c.value.trim()||!l.value)return;const s=c.value,t=l.value.useraccessid,a=new Date().toISOString();if(console.log("Attempting to send chat to",t,"via socket state:",y?.readyState),y&&y.readyState===WebSocket.OPEN){const w=JSON.stringify({type:"chat",target_id:t,data:{text:s,timestamp:a}});y.send(w),console.log("Sent payload:",w)}else console.error("Socket not open!");d.value[t]||(d.value[t]=[]),d.value[t].push({text:s,senderId:T.value,timestamp:a}),c.value="",Z(D.value)},ke=s=>s?new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",Ce={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},$e=async()=>{if(!l.value)return;h.value=!0,E.value="Calling "+l.value.realname+"...",await de(),ce(l.value.useraccessid);const s=await k.value.createOffer();await k.value.setLocalDescription(s),Q("offer",s)},de=async()=>{try{N.value=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),U.value&&(U.value.srcObject=N.value)}catch(s){console.error("Error accessing media devices",s),alert("Could not access camera/microphone."),h.value=!1}},ce=s=>{k.value=new RTCPeerConnection(Ce),N.value&&N.value.getTracks().forEach(t=>{k.value.addTrack(t,N.value)}),k.value.ontrack=t=>{V.value&&(V.value.srcObject=t.streams[0])},k.value.onicecandidate=t=>{t.candidate&&Q("candidate",t.candidate,s)}},Q=(s,t,a)=>{const w=a||l.value?.useraccessid||p.value?.sender_id;y&&w&&y.send(JSON.stringify({type:s,target_id:w,data:t}))},Se=async s=>{const t=s.sender_id,a=g.value.find(w=>w.useraccessid===t)?.realname||"Unknown User";p.value={sender_id:t,callerName:a,offer:s.data}},je=async()=>{if(!p.value)return;const s=p.value.sender_id,t=p.value.offer;p.value=null,h.value=!0,E.value="Connected",await de(),ce(s),await k.value.setRemoteDescription(new RTCSessionDescription(t));const a=await k.value.createAnswer();await k.value.setLocalDescription(a),Q("answer",a,s)},Te=()=>{p.value=null},Ie=async s=>{k.value&&(await k.value.setRemoteDescription(new RTCSessionDescription(s.data)),E.value="Connected")},Ne=async s=>{k.value&&await k.value.addIceCandidate(new RTCIceCandidate(s.data))},Me=()=>{k.value&&k.value.close(),k.value=null,N.value&&(N.value.getTracks().forEach(s=>s.stop()),N.value=null),h.value=!1,E.value=""};return Y(()=>{}),(s,t)=>(o(),r("div",null,[e("div",kt,[e("button",{onClick:pe,class:C(["group relative flex items-center justify-center w-14 h-14 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",{"rotate-0":!u.value,"rotate-90":u.value}])},[x(b)>0&&!u.value?(o(),r("span",Ct,i(x(b)>99?"99+":x(b)),1)):j("",!0),u.value?(o(),r("span",St,[...t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-7 h-7"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):(o(),r("span",$t,[...t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-7 h-7"},[e("path",{"fill-rule":"evenodd",d:"M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813a3.75 3.75 0 0 0 2.576-2.576l.813-2.846A.75.75 0 0 1 9 4.5ZM1.5 9.75a.75.75 0 0 1 1.5 0v.812a.75.75 0 0 1-1.5 0v-.812Zm2.25-.812a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812Zm0 2.25a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812ZM9 15a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812Zm0 2.25a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812ZM15 9.75a.75.75 0 0 1 1.5 0v.812a.75.75 0 0 1-1.5 0v-.812Zm2.25-.812a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812Zm0 2.25a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812ZM4.5 4.5a.75.75 0 0 1 1.5 0v.812a.75.75 0 0 1-1.5 0v-.812Zm2.25-.812a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812Zm0 2.25a.75.75 0 0 1 .75.75v.812a.75.75 0 0 1-.75.75v-.812Z","clip-rule":"evenodd"})],-1)])]))],2)]),I(q,{name:"fade-slide"},{default:A(()=>[u.value?(o(),r("div",jt,[e("div",Tt,[e("button",{onClick:t[0]||(t[0]=a=>f.value="ai"),class:C(["flex-1 py-3 text-sm font-semibold flex justify-center items-center gap-2 transition-colors",f.value==="ai"?"text-indigo-600 bg-white dark:bg-gray-800 border-t-2 border-indigo-600":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"])}," AI Assistant ",2),e("button",{onClick:t[1]||(t[1]=a=>f.value="people"),class:C(["flex-1 py-3 text-sm font-semibold flex justify-center items-center gap-2 transition-colors",f.value==="people"?"text-indigo-600 bg-white dark:bg-gray-800 border-t-2 border-indigo-600":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"])}," People ",2)]),f.value==="ai"?(o(),r("div",It,[t[8]||(t[8]=e("div",{class:"bg-indigo-600 p-3 text-white flex gap-2 items-center text-sm shadow-sm"},[e("i",{class:"fa-solid fa-robot"}),e("span",null,"Ask me to create widgets or menus!")],-1)),e("div",{class:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900",ref_key:"aiMessagesContainer",ref:O},[(o(!0),r(B,null,L($.value,(a,w)=>(o(),r("div",{key:w,class:C(["flex",a.sender==="user"?"justify-end":"justify-start"])},[e("div",{class:C(["max-w-[85%] rounded-lg px-4 py-2 text-sm",a.sender==="user"?"bg-indigo-600 text-white":"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200 shadow-sm border border-gray-200 dark:border-gray-600"])},i(a.text),3)],2))),128))],512),e("div",Nt,[e("form",{onSubmit:P(xe,["prevent"]),class:"flex gap-2"},[G(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>_.value=a),type:"text",placeholder:"Type a command...",class:"flex-1 px-4 py-2 rounded-full bg-gray-100 dark:bg-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[ue,_.value]]),t[7]||(t[7]=e("button",{type:"submit",class:"p-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700"},[e("i",{class:"fa-solid fa-paper-plane px-1"})],-1))],32)])])):(o(),r("div",Mt,[l.value?(o(),r("div",Pt,[e("div",Rt,[e("button",{onClick:t[3]||(t[3]=a=>l.value=null),class:"text-gray-500 hover:text-gray-700"},[...t[10]||(t[10]=[e("i",{class:"fa-solid fa-arrow-left"},null,-1)])]),e("div",Ft,[e("div",Jt,[e("img",{src:ne(l.value),onError:ie,class:"w-8 h-8 rounded-full"},null,40,Ht),l.value.isonline?(o(),r("span",Gt)):j("",!0)]),e("span",Yt,i(l.value.realname),1)]),e("button",{onClick:$e,class:"w-8 h-8 rounded-full bg-green-100 text-green-600 hover:bg-green-200 flex items-center justify-center transition-colors",title:"Video Call"},[...t[11]||(t[11]=[e("i",{class:"fa-solid fa-video"},null,-1)])])]),e("div",{class:"flex-1 overflow-y-auto p-4 space-y-3",ref_key:"chatMessagesContainer",ref:D},[(o(!0),r(B,null,L(d.value[l.value.useraccessid]||[],(a,w)=>(o(),r("div",{key:w,class:C(["flex",a.senderId===x(T)?"justify-end":"justify-start"])},[e("div",{class:C(["max-w-[75%] rounded-xl px-4 py-2 text-sm relative",a.senderId===x(T)?"bg-blue-600 text-white rounded-tr-none":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-sm border border-gray-200 dark:border-gray-700 rounded-tl-none"])},[e("p",null,i(a.text),1),e("p",qt,i(ke(a.timestamp)),1)],2)],2))),128))],512),e("div",Kt,[e("form",{onSubmit:P(we,["prevent"]),class:"flex gap-2"},[G(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>c.value=a),type:"text",placeholder:"Message...",class:"flex-1 px-4 py-2 rounded-full bg-gray-100 dark:bg-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ue,c.value]]),t[12]||(t[12]=e("button",{type:"submit",class:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700"},[e("i",{class:"fa-solid fa-paper-plane px-1"})],-1))],32)])])):(o(),r("div",At,[v.value?(o(),r("div",Ot,"Loading users...")):g.value.length===0?(o(),r("div",Ut,"No users found.")):j("",!0),(o(!0),r(B,null,L(g.value,a=>(o(),r("div",{key:a.useraccessid,onClick:w=>be(a),class:"flex items-center gap-3 p-3 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer transition-colors"},[e("div",zt,[e("img",{src:ne(a),onError:ie,class:"w-10 h-10 rounded-full object-cover border border-gray-200"},null,40,Bt),a.isonline?(o(),r("span",Lt)):j("",!0)]),e("div",Dt,[e("h4",Wt,i(a.realname),1),e("p",Vt,i(a.email),1)]),S.value[a.useraccessid]?(o(),r("div",Zt,i(S.value[a.useraccessid]),1)):j("",!0),t[9]||(t[9]=e("i",{class:"fa-solid fa-chevron-right text-gray-300"},null,-1))],8,Et))),128))]))]))])):j("",!0)]),_:1}),h.value?(o(),r("div",Qt,[e("div",Xt,[e("video",{ref_key:"remoteVideo",ref:V,autoplay:"",playsinline:"",class:"w-full h-full object-cover"},null,512),e("div",es,[e("video",{ref_key:"localVideo",ref:U,autoplay:"",playsinline:"",muted:"",class:"w-full h-full object-cover"},null,512)]),e("div",ts,i(E.value),1)]),e("div",{class:"p-4 bg-gray-800 flex justify-center gap-4"},[e("button",{onClick:Me,class:"w-12 h-12 rounded-full bg-red-600 text-white hover:bg-red-700 flex items-center justify-center shadow-lg transform hover:scale-105 transition-all"},[...t[13]||(t[13]=[e("i",{class:"fa-solid fa-phone-slash text-xl"},null,-1)])])])])):j("",!0),p.value?(o(),r("div",ss,[e("div",as,[t[15]||(t[15]=e("div",{class:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-600"},[e("i",{class:"fa-solid fa-video text-xl animate-pulse"})],-1)),e("div",null,[t[14]||(t[14]=e("h4",{class:"font-bold text-gray-900 dark:text-white"},"Incoming Call",-1)),e("p",os,i(p.value.callerName),1)])]),e("div",{class:"flex gap-2"},[e("button",{onClick:je,class:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-medium text-sm"},"Accept"),e("button",{onClick:Te,class:"flex-1 bg-red-100 hover:bg-red-200 text-red-600 py-2 rounded-lg font-medium text-sm"},"Decline")])])):j("",!0)]))}}),ls=Object.assign(te(rs,[["__scopeId","data-v-000691d6"]]),{__name:"AiAssistant"}),ns={class:"flex min-h-screen transition-colors duration-300",style:{background:"var(--content-background, #f8fafc)"}},is={class:"flex items-center h-16 px-4",style:{"border-bottom":"1px solid var(--sidebar-border-color)"}},ds={key:0,class:"flex items-center gap-3 flex-1"},cs={class:"text-base font-bold tracking-tight truncate",style:{color:"var(--sidebar-title-color)"}},us={key:1,class:"w-full flex justify-center"},fs={class:"flex-1 overflow-y-auto py-4 px-3 space-y-1 custom-scrollbar"},gs=["onClick","title"],vs={class:"menu-icon w-6 flex items-center justify-center transition-all duration-200 shrink-0"},ms={key:0,class:"menu-label flex-1 text-left text-sm font-medium capitalize truncate"},ps={key:1,class:"w-6 h-6 flex items-center justify-center rounded-lg"},xs={key:0,class:"mt-1 ml-6 pl-3 space-y-0.5",style:{"border-left":"2px solid var(--sidebar-submenu-border-color)"}},bs={class:"text-sm truncate"},hs={class:"p-3",style:{"border-top":"1px solid var(--sidebar-border-color)"}},ys={key:0,class:"flex-1 min-w-0"},_s={class:"text-sm font-semibold truncate",style:{color:"var(--sidebar-profile-name-color)"}},ws={class:"text-xs truncate",style:{color:"var(--sidebar-profile-email-color)"}},ks={class:"flex-1 flex flex-col min-h-screen overflow-hidden"},Cs={class:"flex-1 overflow-auto"},zs=R({__name:"auth",setup(F){const u=se(),f=re(),{t:_}=Le(),$=oe(),{me:g}=ae(),v=H(),l=n(!1),c=n({}),d=n([]),S={dashboard:"fa-solid fa-gauge-high",user:"fa-solid fa-users",users:"fa-solid fa-users",role:"fa-solid fa-user-shield",roles:"fa-solid fa-user-shield",permission:"fa-solid fa-key",permissions:"fa-solid fa-key",menu:"fa-solid fa-bars",menus:"fa-solid fa-bars",setting:"fa-solid fa-cog",settings:"fa-solid fa-cog",report:"fa-solid fa-chart-line",reports:"fa-solid fa-chart-line",workflow:"fa-solid fa-diagram-project",article:"fa-solid fa-newspaper",articles:"fa-solid fa-newspaper",theme:"fa-solid fa-palette",themes:"fa-solid fa-palette",master:"fa-solid fa-database",transaction:"fa-solid fa-exchange-alt",form:"fa-solid fa-window-maximize",forms:"fa-solid fa-window-maximize",widget:"fa-solid fa-puzzle-piece",widgets:"fa-solid fa-puzzle-piece",dbobject:"fa-solid fa-server",admin:"fa-solid fa-shield-halved",default:"fa-solid fa-folder"},M=m=>{const h=m?.toLowerCase()||"";return S[h]||S.default};Y(async()=>{u.applyCurrentTheme(),await f.connect(),await f.fetchUnread();try{const m=await g();m?.code===200&&m.data?.menus?d.value=m.data.menus:console.error("Invalid response from /auth/me",m)}catch(m){console.error("Error loading user info:",m)}});const T=z(()=>Array.isArray(d.value)?[...d.value].sort((m,h)=>(m.sortorder??0)-(h.sortorder??0)):[]),b=z(()=>T.value.filter(m=>!m.parentid||m.parentid===0)),O=m=>T.value.filter(h=>h.parentid===m).sort((h,U)=>(h.sortorder??0)-(U.sortorder??0)),D=()=>l.value=!l.value,J=m=>{c.value[m]=!c.value[m]};return(m,h)=>{const U=Ue,V=me,k=Ee,N=We,E=Oe;return o(),ge(E,null,{default:A(()=>[I(N,null,{default:A(()=>[e("div",ns,[e("aside",{class:C(["relative flex flex-col transition-all duration-300 ease-out overflow-visible sidebar-theme",l.value?"w-[72px]":"w-64"]),style:{background:"var(--sidebar-background)","border-right":"1px solid var(--sidebar-border-color)"}},[e("div",is,[l.value?(o(),r("div",us,[...h[1]||(h[1]=[e("div",{class:"w-9 h-9 rounded-xl flex items-center justify-center shadow-lg",style:{background:"var(--sidebar-logo-background, linear-gradient(135deg, #6366f1, #9333ea))"}},[e("i",{class:"fa-solid fa-cube text-sm",style:{color:"var(--sidebar-logo-color, #fff)"}})],-1)])])):(o(),r("div",ds,[h[0]||(h[0]=e("div",{class:"w-9 h-9 rounded-xl flex items-center justify-center shadow-lg",style:{background:"var(--sidebar-logo-background, linear-gradient(135deg, #6366f1, #9333ea))"}},[e("i",{class:"fa-solid fa-cube text-sm",style:{color:"var(--sidebar-logo-color, #fff)"}})],-1)),e("h2",cs,i(x(v).public.appName),1)]))]),e("button",{onClick:D,class:"absolute -right-4 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 collapse-btn",style:{background:"var(--sidebar-collapse-background)",color:"var(--sidebar-collapse-color)","z-index":"100"}},[e("i",{class:C([l.value?"fa-solid fa-chevron-right":"fa-solid fa-chevron-left","text-xs"])},null,2)]),e("nav",fs,[(o(!0),r(B,null,L(b.value,p=>(o(),r("div",{key:p.menuaccessid,class:"mb-1"},[e("button",{onClick:W=>O(p.menuaccessid).length?J(p.menuaccessid):null,class:C(["menu-item w-full flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 group",c.value[p.menuaccessid]?"active":""]),title:l.value?x(_)(p.description.toUpperCase()):""},[e("div",vs,[e("i",{class:C([M(p.menuname),"text-base"])},null,2)]),l.value?j("",!0):(o(),r("span",ms,i(x(_)(p.description.toUpperCase())),1)),O(p.menuaccessid).length&&!l.value?(o(),r("div",ps,[e("i",{class:C(["text-[10px] transition-transform duration-200",c.value[p.menuaccessid]?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down"]),style:{color:"var(--sidebar-menu-color)"}},null,2)])):j("",!0)],10,gs),I(q,{name:"slide-fade"},{default:A(()=>[l.value?j("",!0):G((o(),r("div",xs,[(o(!0),r(B,null,L(O(p.menuaccessid),W=>(o(),ge(U,{key:W.menuaccessid,to:`/admin/${W.menuname.toLowerCase()}`,class:"submenu-item flex items-center gap-2.5 px-3 py-2 rounded-lg transition-all duration-200"},{default:A(()=>[e("i",{class:C([M(W.menuname),"text-[11px] opacity-70 w-4"])},null,2),e("span",bs,i(x(_)(W.description.toUpperCase())),1)]),_:2},1032,["to"]))),128))],512)),[[De,c.value[p.menuaccessid]]])]),_:2},1024)]))),128))]),e("div",hs,[e("div",{class:C(["flex items-center gap-3 p-2 rounded-xl transition-all duration-200 cursor-pointer profile-item",l.value?"justify-center":""])},[h[2]||(h[2]=e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center font-semibold text-sm shrink-0",style:{color:"var(--sidebar-profile-icon-color)"}},[e("i",{class:"fa-solid fa-user-circle text-2xl"})],-1)),l.value?j("",!0):(o(),r("div",ys,[e("p",_s,i(x($).user?.realname),1),e("p",ws,i(x($).user?.email),1)]))],2)])],2),e("main",ks,[I(wt,{class:"sticky top-0 z-40 backdrop-blur-xl navbar-theme"},{right:A(()=>[I(V)]),_:1}),e("div",Cs,[I(k)])])]),I(ls)]),_:1})]),_:1})}}});export{zs as default};
