import{n as Se,k,e as Te,j as O,q as $e,s as K,x as Le,c as b,a as l,m as L,F as D,r as I,h as Q,l as g,v as A,t as S,y as Z,z as De,o as v,A as ee,B as Ie,C as Me}from"#entry";import{u as Re}from"./BKu5god-.js";import"./BJZKwT5v.js";import{u as Ee}from"./sbBiWOa1.js";import"./VUwJYlGX.js";const Ve=Se("dbobject",()=>{const E=k([]),_=k({dbobjectid:"",objectname:"",dbobjecttypeid:"",objectcontent:"",objectversion:"",ispublished:0,comment:""}),C=k(!1),r=Re();async function f(){C.value=!0;try{let m=new FormData;m.append("flowname","searchcombodbobjecttype"),m.append("menu","admin"),m.append("search","true");let p=await r.post("/admin/execute-flow",m);E.value=p?.data?.data??{},m=new FormData,m.append("flowname","searchdbobject"),m.append("menu","admin"),m.append("search","true"),p=await r.post("/admin/execute-flow",m),E.value=p?.data?.data??{}}finally{C.value=!1}}async function w(m){C.value=!0;try{const p=new FormData;p.append("flowname","getdbobject"),p.append("menu","admin"),p.append("search","true"),p.append("dbobjectid",m);const N=await r.post("/admin/execute-flow",p);_.value=N?.data?.data??{}}finally{C.value=!1}}async function x(m){try{const p=new FormData;p.append("flowname","modifdbobject"),p.append("menu","admin"),p.append("search","true"),p.append("dbobjectid",m.dbobjectid),p.append("objectname",m.objectname),p.append("dbobjecttypeid",m.dbobjecttypeid),p.append("objectcontent",m.objectcontent),p.append("ispublished",m.ispublished),p.append("comment",m.comment),await r.post("/admin/execute-flow",p)}finally{C.value=!1}}async function T(m){try{const p=new FormData;p.append("flowname","purgedbobject"),p.append("menu","admin"),p.append("search","true"),p.append("dbobjectid",m),await r.post("/admin/execute-flow",p)}finally{C.value=!1}}return{fetchAll:f,fetch:w,saveTable:x,purgeTable:T,dbobject:_,dbobjects:E,loading:C}}),Ue={class:"h-screen flex flex-col bg-gray-50"},Fe={class:"flex items-center justify-between p-4 border-b bg-white"},Oe={class:"flex items-center gap-2"},Pe={class:"flex flex-1 overflow-hidden"},Ye=["data-area-id","onMousedown"],Xe={class:"bg-purple-600 text-white text-xs px-2 py-1 rounded-t-xl cursor-move flex items-center justify-between"},Be=["onUpdate:modelValue"],We=["onClick"],Je=["onMousedown"],ze={class:"absolute inset-0 pointer-events-none",style:{overflow:"visible"}},qe=["d"],Ge=["d"],He=["onDragstart","onDblclick","data-table-id"],Ke={class:"flex items-center justify-between p-2 bg-gray-800 text-white rounded-t"},Qe={class:"font-medium"},Ze={class:"flex gap-1"},et=["onClick"],tt=["onClick"],ot={class:"p-2 text-xs"},nt=["data-col-index"],lt={class:"w-6 text-gray-600"},st={class:"flex-1 truncate"},it={class:"text-gray-500 text-[11px]"},at=["onPointerdown"],dt={class:"w-96 border-l bg-white p-4 overflow-auto"},rt={class:"mt-4"},ct={class:"flex gap-2 mt-1"},ut={key:0,class:"space-y-4"},pt={class:"text-lg font-semibold"},mt={class:"flex gap-2 mt-1"},ft={class:"mt-2 space-y-2"},bt=["onUpdate:modelValue"],vt=["onUpdate:modelValue"],ht=["onUpdate:modelValue"],xt=["onUpdate:modelValue"],wt=["onClick"],yt={class:"flex gap-2"},gt={class:"mt-4"},Ct={key:0},kt={class:"text-sm"},_t={class:"flex gap-2"},jt=["onClick"],At={key:1,class:"text-gray-400 text-sm"},Dt=Te({__name:"dbobject",setup(E){let _=1,C=1;const r=O([]),f=O([]),w=Ee(),x=O([]);let T=1;const m=k(null),p=k(null),N=k({x:0,y:0}),P=k(null),V=k(null),Y=k({x:0,y:0}),U=k(null),M=k(""),F=Ve();k({dbobjectid:"",objectname:"",dbobjecttypeid:"",objectcontent:"",objectversion:"",ispublished:0,comment:""});const h=O({active:!1,from:null,sx:0,sy:0,path:""});function te(o=40,t=40){const e={id:_++,dbid:"",name:`table_${_}`,x:o,y:t,width:240,columns:[{name:"id",type:"auto"},{name:"name",type:"text"}]};r.push(e)}function oe(){const n=r.length,i=Math.floor(n/4),a=n%4;te(40+a*340,40+i*200)}function ne(o,t){let e=0,n=0,i=120,a=[];if(o.objectcontent)try{const d=JSON.parse(o.objectcontent);d?.table?.columns&&Array.isArray(d.table.columns)&&(a=d.table.columns.map(c=>({name:c.name||"col",type:c.type||"text",allownull:c.allownull??!1,default:c.default??""}))),e=d?.table?.x??40+t%4*340,n=d?.table?.y??40+Math.floor(t/4)*200,i=d?.table?.width??240,d.areas&&d.areas.length>0&&d.areas.forEach(c=>{x.find(y=>y.id==c.id)==null&&le(c)})}catch(d){console.warn(`Invalid objectcontent JSON for ${o.objectname}`,d)}return{id:_++,dbid:o.dbobjectid??"",name:o.objectname||`table_${t+1}`,x:e,y:n,width:i,columns:a,ispublished:o.ispublished==1,comment:o.comment??""}}function le(o){console.log("data ",o);const t={id:o.id,name:o.name,x:o.x,y:o.y,width:o.width,height:o.height,color:o.color,type:"area"};x.push(t),se(t)}function se(o){const t=document.createElement("div");t.className="design-area",t.style.left=o.x+"px",t.style.top=o.y+"px",t.style.width=o.width+"px",t.style.height=o.height+"px",t.style.background=o.color||"#fef9c3",t.dataset.id=o.id,t.dataset.type="area",makeAreaDraggableAndResizable(t,o)}function J(o){P.value=o;const t=r.find(e=>e.id===o);M.value=t?JSON.stringify(t,null,2):""}const u=$e(()=>r.find(o=>o.id===P.value)||null);function ie(o,t){V.value=o.id;const e=t.target.getBoundingClientRect();Y.value={x:t.clientX-e.left,y:t.clientY-e.top}}function ae(o){const t=U.value.getBoundingClientRect();if(!V.value)return;const e=r.find(n=>n.id===V.value);e&&(e.x=o.clientX-t.left-Y.value.x,e.y=o.clientY-t.top-Y.value.y,V.value=null,j())}async function de(o){if(!confirm("Are you sure to delete Area ?"))return;const t=x.findIndex(e=>e.id===o);t>=0&&x.splice(t,1)}async function re(o){if(!confirm("Are you sure to delete Table?"))return;const t=r.findIndex(n=>n.id===o),e=r.find(n=>n.id===o);e.dbid&&await F.purgeTable(e.dbid),t>=0&&r.splice(t,1);for(let n=f.length-1;n>=0;n--)(f[n].from.table===o||f[n].to.table===o)&&f.splice(n,1)}function ce(o){const t=JSON.parse(JSON.stringify(o));t.id=_++,t.dbid="",t.x+=20,t.y+=20,t.name=o.name+"_copy",r.push(t),j()}function ue(){u.value&&u.value.columns.push({name:"new_col",type:"varchar"})}function pe(o){u.value&&u.value.columns.splice(o,1)}function me(){if(u.value)try{const o=JSON.parse(M.value);u.value.name=o.name||u.value.name,u.value.x=Number(o.x??u.value.x),u.value.y=Number(o.y??u.value.y),u.value.width=Number(o.width??u.value.width),Array.isArray(o.columns)&&(u.value.columns=o.columns),j(),alert("Applied to selected table")}catch{alert("Invalid JSON")}}function fe(){navigator.clipboard.writeText(M.value).then(()=>alert("Copied"))}async function be(){confirm("Reset design?")&&await z()}function ve(o,t){f.splice(0,f.length),o.forEach(e=>{if(!e.objectcontent)return;let n;try{n=JSON.parse(e.objectcontent)}catch{return}!n.relations||!Array.isArray(n.relations)||n.relations.forEach(i=>{const a=t[i.from.table],s=t[i.to.table];!a||!s||f.some(c=>c.from.table===a&&c.from.col===i.from.col&&c.to.table===s&&c.to.col===i.to.col)||f.push({id:C++,from:{table:a,col:i.from.col,colName:i.from.colName},to:{table:s,col:i.to.col,colName:i.to.colName},path:""})})}),j()}async function z(){r.splice(0,r.length),f.splice(0,f.length),x.splice(0,x.length),_=1,C=1,P.value=null,await F.fetchAll();const o=new Set,t=[],e={};(F.dbobjects||[]).forEach(n=>{const i=n?.dbobjectid?String(n.dbobjectid):n?.objectname??"";i&&(o.has(i)?console.debug("Skipping duplicate dbobject from store:",i):(o.add(i),t.push(n)))}),t.forEach((n,i)=>{const a=ne(n,i);e[n.dbobjectid]=a.id,r.push(a)}),_=Math.max(...r.map(n=>n.id),0)+1,ve(t,e),j()}function he(o,t,e){const n=U.value.getBoundingClientRect(),i=r.find(c=>c.id===o);if(!i)return;const a=i.y+36+t*24;h.active=!0,h.from={table:o,col:t},h.sx=i.x+i.width,h.sy=a,q(e.clientX-n.left,e.clientY-n.top);const s=c=>q(c.clientX-n.left,c.clientY-n.top),d=c=>xe(c,s,d);window.addEventListener("pointermove",s),window.addEventListener("pointerup",d)}function q(o,t){h.path=G(h.sx,h.sy,o,t)}function xe(o,t,e){if(window.removeEventListener("pointermove",t),window.removeEventListener("pointerup",e),!h.active)return;const n=U.value.getBoundingClientRect(),i=o.clientX-n.left,a=o.clientY-n.top;let s=null;for(const d of r)if(i>=d.x&&i<=d.x+d.width&&a>=d.y&&a<=d.y+200){const c=Math.floor((a-(d.y+36))/24);if(c>=0&&c<d.columns.length){s={table:d.id,col:c};break}}if(s){const d={id:C++,from:{table:h.from.table,col:h.from.col,colName:r.find(c=>c.id===h.from.table).columns[h.from.col].name},to:{table:s.table,col:s.col,colName:r.find(c=>c.id===s.table).columns[s.col].name},path:""};f.push(d),j()}h.active=!1,h.path=""}function G(o,t,e,n){const i=(o+e)/2;return`M ${o} ${t} C ${i} ${t} ${i} ${n} ${e} ${n}`}function j(){f.forEach(o=>{const t=r.find(d=>d.id===o.from.table),e=r.find(d=>d.id===o.to.table);if(!t||!e)return;const n=t.y+36+o.from.col*24,i=t.x+t.width,a=e.y+36+o.to.col*24,s=e.x;o.path=G(i,n,s,a)})}function we(o){const t=f.findIndex(e=>e.id===o);t>=0&&f.splice(t,1)}K(r,j,{deep:!0}),K(f,j,{deep:!0});async function ye(){if(!r.length)return alert("No tables to save");try{for(const o of De(r)){const t={table:o,relations:f.filter(s=>s.from.table===o.id||s.to.table===o.id).map(s=>({id:s.id,from:{...s.from,table:r.find(d=>d.id===s.from.table)?.dbid},to:{...s.to,table:r.find(d=>d.id===s.to.table)?.dbid}})),areas:x},e={dbobjectid:o.dbid?String(o.dbid):"",objectname:o.name,dbobjecttypeid:"1",objectcontent:JSON.stringify(t),objectversion:"1",ispublished:o.ispublished?1:0,comment:o.comment||""},n=await F.saveTable(e),i=n?.data?.data??n,a=i?.dbobjectid??i?.dbobjectid??null;if(a){const s=r.find(d=>d.id===o.id);s&&(s.dbid=a)}}w.add({title:"Success",description:"Runtime schema saved successfully",color:"success"})}catch(o){console.error(o),w.add({title:"Error",description:String(o),color:"error"})}}Le(async()=>{await z()});function ge(){T=T+1,x.push({id:T,name:"Area "+T,x:100,y:100,width:400,height:300,color:"#e3e9ff"})}function Ce(o,t){m.value=o,p.value="move",N.value={x:t.clientX-o.x,y:t.clientY-o.y},window.addEventListener("mousemove",X),window.addEventListener("mouseup",B)}function ke(o,t){m.value=o,p.value="resize",N.value={x:t.clientX,y:t.clientY},window.addEventListener("mousemove",X),window.addEventListener("mouseup",B)}function X(o){if(!m.value)return;const t=m.value;if(p.value==="move"&&(t.x=o.clientX-N.value.x,t.y=o.clientY-N.value.y),p.value==="resize"){const e=o.clientX-N.value.x,n=o.clientY-N.value.y;t.width+=e,t.height+=n,N.value={x:o.clientX,y:o.clientY}}}function B(){m.value=null,p.value=null,window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",B)}function _e(o){!o||!o.columns||o.columns.forEach(t=>{const e=(t.name||"").toLowerCase();e.includes("id")?t.type="auto":e.includes("date")||e.endsWith("at")?t.type="timestamp":e.startsWith("is")||e.startsWith("has")?t.type="boolean":e.includes("amount")||e.includes("price")||e.includes("total")?t.type="number":t.type="text"})}function H(){const o=new Set(f.map(e=>`${e.from.table}_${e.from.col}-${e.to.table}_${e.to.col}`)),t=r.reduce((e,n)=>{const i=n.columns.map((a,s)=>a.type==="auto"?s:null).filter(a=>a!==null);return e[n.id]=i,e},{});for(let e=0;e<r.length;e++){const n=r[e];for(let i=0;i<r.length;i++){if(e===i)continue;const a=r[i];n.columns.forEach((s,d)=>{if(s.name.toLowerCase()===a.name.toLowerCase()+"id"){if(!t[a.id]||t[a.id].length===0)return;const c=t[a.id][0],y=`${n.id}_${d}-${a.id}_${c}`,R=`${a.id}_${c}-${n.id}_${d}`;if(o.has(y)||o.has(R))return;f.push({id:C++,from:{table:n.id,col:d,colName:s.name},to:{table:a.id,col:c,colName:a.columns[c].name},path:""}),o.add(y)}})}}j(),w.add({title:"Auto Relations",description:"Relations generated intelligently",color:"success"})}function je(o){if(!o)return;const e=o.trim().split(/\s+/)[0]||"table_"+_;if(r.some(s=>s.name.toLowerCase()===e.toLowerCase())){w.add({title:"Duplicate Table",description:`Table with name "${e}" already exists!`,color:"warning"});return}let n=o.toLowerCase().split("with")[1]||"";n=n.replace(/and/g,",");const i=n.split(",").map(s=>s.trim()).filter(s=>s),a={id:_++,dbid:"",name:e,x:40+r.length%4*340,y:40+Math.floor(r.length/4)*200,width:240,columns:i.map(s=>{let d="text";return s.includes("id")&&s.replace(/_/g,"").includes(e.toLowerCase())?d="auto":s.includes("id")?d="int":s.includes("date")||s.endsWith("at")?d="timestamp":s.startsWith("is")||s.startsWith("has")||s.startsWith("recordstatus")?d="boolean":(s.includes("amount")||s.includes("price")||s.includes("total"))&&(d="number"),{name:s,type:d}}),ispublished:!1,comment:""};r.push(a),J(a.id),j(),H(),w.add({title:"AI Table Generated",description:`Table "${e}" created!`,color:"success"})}function Ae(o){if(!o)return;const t=o.split(/[\.\n]/).map(e=>e.trim()).filter(Boolean);for(const e of t){const n=e.toLowerCase();if(n.startsWith("create table")){const i=e.replace(/create table/i,"").trim();je(i);continue}if(n.includes("add column")){const i=/add column (\w+)(?: (above|below) (\w+))?(?: (?:to|in) (\w+))?/i.exec(e);if(i){const[,a,s,d,c]=i;let y=null;if(c){if(y=r.find(W=>W.name.toLowerCase()===c.toLowerCase()),!y){w.add({title:"Table Not Found",description:`Table "${c}" not found`,color:"warning"});continue}}else if(y=u.value||r[r.length-1],!y){w.add({title:"No Table Selected",description:`Cannot add column "${a}"`,color:"warning"});continue}const R=d?y.columns.findIndex(W=>W.name.toLowerCase()===d.toLowerCase()):-1;let $="text";a.includes("id")&&a.replace(/_/g,"").includes(y.name.toLowerCase())?$="auto":a.includes("id")?$="int":a.includes("date")||a.endsWith("at")?$="timestamp":a.startsWith("is")||a.startsWith("has")||a.startsWith("recordstatus")?$="boolean":(a.includes("amount")||a.includes("price")||a.includes("total"))&&($="number");const Ne=R>=0?s==="above"?R:R+1:y.columns.length;y.columns.splice(Ne,0,{name:a,type:$})}continue}if(n.includes("remove column")||n.includes("delete column")){const i=/(?:remove|delete) column (\w+)/i.exec(e);if(i){const[,a]=i;let s=u.value;if(!s){w.add({title:"No Table Selected",description:`Cannot remove column "${a}"`,color:"warning"});continue}const d=s.columns.findIndex(c=>c.name.toLowerCase()===a.toLowerCase());d>=0&&s.columns.splice(d,1)}continue}if(n.includes("delete table")){const a=/delete table (\w+)?/i.exec(e)?.[1];if(a){const s=r.findIndex(d=>d.name.toLowerCase()===a.toLowerCase());s>=0&&r.splice(s,1)}else if(u.value){const s=r.findIndex(d=>d.id===u.value.id);s>=0&&r.splice(s,1)}else w.add({title:"No Table Selected",description:"Cannot delete table",color:"warning"});continue}if(n.includes("delete area")){const a=/delete area (\w+)?/i.exec(e)?.[1];if(a){const s=x.findIndex(d=>d.name.toLowerCase()===a.toLowerCase());s>=0&&x.splice(s,1)}else if(m.value){const s=x.findIndex(d=>d.id===m.value.id);s>=0&&x.splice(s,1)}else w.add({title:"No Area Selected",description:"Cannot delete area",color:"warning"});continue}console.warn("Unknown instruction:",e)}j(),w.add({title:"AI Natural Instructions Executed",description:"All recognized actions applied.",color:"success"})}return(o,t)=>(v(),b("div",Ue,[l("header",Fe,[t[13]||(t[13]=l("div",{class:"flex items-center gap-3"},[l("h1",{class:"text-xl font-semibold"},"Database Designer")],-1)),l("div",Oe,[l("button",{onClick:oe,class:"px-3 py-2 rounded bg-green-600 text-white"},"Add Table"),l("button",{onClick:ge,class:"px-3 py-2 rounded bg-purple-600 text-white"},"Add Area"),l("button",{onClick:ye,class:"px-3 py-1 rounded bg-green-600 text-white"},"Save"),l("button",{onClick:be,class:"px-3 py-1 rounded bg-red-500 text-white"},"Reset"),l("button",{onClick:t[0]||(t[0]=e=>H()),class:"px-3 py-1 bg-purple-500 text-white rounded"}," AI Suggest Relations ")])]),l("div",Pe,[l("div",{class:"flex-1 relative p-4 bg-gray-100",onDragover:t[1]||(t[1]=L(()=>{},["prevent"])),onDrop:ae,ref_key:"canvasRef",ref:U,id:"drawflow"},[(v(!0),b(D,null,I(x,e=>(v(),b("div",{key:e.id,"data-area-id":e.id,class:"absolute rounded-xl border border-purple-400 bg-purple-200/30",style:ee({left:e.x+"px",top:e.y+"px",width:e.width+"px",height:e.height+"px"}),onMousedown:n=>Ce(e,n)},[l("div",Xe,[g(l("input",{"onUpdate:modelValue":n=>e.name=n,class:"bg-purple-600 outline-none flex-1 rounded px-2"},null,8,Be),[[A,e.name]]),l("button",{onClick:L(n=>de(e.id),["stop"]),class:"ml-2 text-white hover:text-red-300 font-bold",title:"Delete Area"}," ✕ ",8,We)]),l("div",{class:"absolute bottom-0 right-0 w-4 h-4 bg-purple-600 cursor-se-resize rounded",onMousedown:L(n=>ke(e,n),["stop"])},null,40,Je)],44,Ye))),128)),(v(),b("svg",ze,[t[14]||(t[14]=l("defs",null,[l("marker",{id:"arrow",markerWidth:"10",markerHeight:"10",refX:"10",refY:"5",orient:"auto"},[l("path",{d:"M0,0 L10,5 L0,10 z",fill:"black"})])],-1)),(v(!0),b(D,null,I(f,e=>(v(),b("g",{key:e.id},[l("path",{d:e.path,stroke:"black","stroke-width":"2",fill:"none","marker-end":"url(#arrow)"},null,8,qe)]))),128)),h.active?(v(),b("path",{key:0,d:h.path,stroke:"gray","stroke-width":"2",fill:"none","stroke-dasharray":"6 4"},null,8,Ge)):Q("",!0)])),(v(!0),b(D,null,I(r,e=>(v(),b("div",{key:e.id,class:"absolute shadow-lg rounded border bg-white cursor-move",style:ee({left:e.x+"px",top:e.y+"px",width:e.width+"px"}),draggable:"true",onDragstart:n=>ie(e,n),onDblclick:n=>J(e.id),"data-table-id":e.id},[l("div",Ke,[l("div",Qe,S(e.name||"table_"+e.id),1),l("div",Ze,[l("button",{onClick:L(n=>ce(e),["stop"]),title:"Duplicate",class:"text-xs px-2"},"⧉",8,et),l("button",{onClick:L(n=>re(e.id),["stop"]),title:"Delete",class:"text-xs px-2"},"✕",8,tt)])]),l("div",ot,[(v(!0),b(D,null,I(e.columns,(n,i)=>(v(),b("div",{key:i,class:"flex items-center gap-2","data-col-index":i},[l("span",lt,S(i+1),1),l("span",st,S(n.name),1),l("span",it,S(n.type||""),1),l("button",{onPointerdown:L(a=>he(e.id,i,a),["stop","prevent"]),class:"w-4 h-4 rounded-full bg-blue-500",title:"Start relation"},null,40,at)],8,nt))),128))])],44,He))),128)),t[15]||(t[15]=l("div",{class:"absolute left-4 bottom-4"},null,-1))],544),l("aside",dt,[l("div",rt,[t[16]||(t[16]=l("label",{class:"text-sm font-semibold"},"AI Prompt",-1)),l("div",ct,[g(l("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.aiDescription=e),placeholder:"e.g. Customer table with id, name, email",class:"flex-1 p-2 border rounded"},null,512),[[A,o.aiDescription]]),l("button",{onClick:t[3]||(t[3]=e=>Ae(o.aiDescription)),class:"px-3 py-1 bg-yellow-500 text-white rounded"},"Generate")])]),u.value?(v(),b("div",ut,[l("h2",pt,"Properties — "+S(u.value.name||"Untitled"),1),l("div",null,[t[17]||(t[17]=l("label",{class:"text-sm text-gray-600"},"Table Name",-1)),g(l("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>u.value.name=e),class:"w-full mt-1 p-2 border rounded"},null,512),[[A,u.value.name]])]),l("div",null,[t[18]||(t[18]=l("label",{class:"text-sm text-gray-600"},"Comment",-1)),g(l("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>u.value.comment=e),class:"w-full mt-1 p-2 border rounded"},null,512),[[A,u.value.comment]])]),l("div",null,[t[19]||(t[19]=l("label",{class:"text-sm text-gray-600"},"Is Published",-1)),g(l("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>u.value.ispublished=e),class:"w-full mt-1 p-2 border rounded"},null,512),[[Z,u.value.ispublished]])]),l("div",null,[t[20]||(t[20]=l("label",{class:"text-sm text-gray-600"},"Position",-1)),l("div",mt,[g(l("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>u.value.x=e),class:"w-1/3 p-2 border rounded"},null,512),[[A,u.value.x,void 0,{number:!0}]]),g(l("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=e=>u.value.y=e),class:"w-1/3 p-2 border rounded"},null,512),[[A,u.value.y,void 0,{number:!0}]]),g(l("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=e=>u.value.width=e),class:"w-1/3 p-2 border rounded"},null,512),[[A,u.value.width,void 0,{number:!0}]])])]),l("div",null,[t[22]||(t[22]=l("label",{class:"text-sm text-gray-600"},"Columns",-1)),l("div",ft,[(v(!0),b(D,null,I(u.value.columns,(e,n)=>(v(),b("div",{key:n,class:"flex items-center gap-2"},[g(l("input",{"onUpdate:modelValue":i=>e.name=i,placeholder:"name",class:"flex-1 p-2 border rounded"},null,8,bt),[[A,e.name]]),g(l("select",{"onUpdate:modelValue":i=>e.type=i,placeholder:"type",class:"w-36 p-2 border rounded"},[...t[21]||(t[21]=[Me('<option value="auto">Auto Increment</option><option value="text">Text</option><option value="longtext">Long Text</option><option value="number">Number</option><option value="integer">Integer</option><option value="timestamp">Time stamp</option><option value="boolean">Boolean</option>',7)])],8,vt),[[Ie,e.type]]),g(l("input",{type:"checkbox","onUpdate:modelValue":i=>e.allownull=i,placeholder:"type",class:"w-36 p-2 border rounded"},null,8,ht),[[Z,e.allownull]]),g(l("input",{"onUpdate:modelValue":i=>e.default=i,placeholder:"default",class:"flex-1 p-2 border rounded"},null,8,xt),[[A,e.default]]),l("button",{onClick:i=>pe(n),class:"px-2 py-1 bg-red-500 text-white rounded"},"-",8,wt)]))),128)),l("div",yt,[l("button",{onClick:t[10]||(t[10]=e=>ue()),class:"px-3 py-1 bg-blue-600 text-white rounded"},"Add Column"),l("button",{onClick:t[11]||(t[11]=e=>_e(u.value)),class:"px-3 py-1 bg-yellow-500 text-white rounded"}," AI Suggest Types ")])])]),l("div",null,[t[23]||(t[23]=l("label",{class:"text-sm text-gray-600"},"Raw JSON",-1)),g(l("textarea",{"onUpdate:modelValue":t[12]||(t[12]=e=>M.value=e),rows:"6",class:"w-full p-2 border rounded mt-1 text-xs font-mono"},null,512),[[A,M.value]]),l("div",{class:"flex gap-2 mt-2"},[l("button",{onClick:me,class:"px-3 py-1 bg-green-600 text-white rounded"},"Apply"),l("button",{onClick:fe,class:"px-3 py-1 bg-indigo-600 text-white rounded"},"Copy")])])])):Q("",!0),l("div",gt,[t[24]||(t[24]=l("h3",{class:"font-semibold"},"Relations",-1)),f.length?(v(),b("div",Ct,[(v(!0),b(D,null,I(f,e=>(v(),b("div",{key:e.id,class:"flex items-center justify-between mt-2"},[l("div",kt,S(e.from.table)+"."+S(e.from.col)+" ➜ "+S(e.to.table)+"."+S(e.to.col??"-"),1),l("div",_t,[l("button",{onClick:n=>we(e.id),class:"px-2 py-1 bg-red-500 text-white rounded"},"Delete",8,jt)])]))),128))])):(v(),b("div",At,"No relations"))])])])]))}});export{Dt as default};
