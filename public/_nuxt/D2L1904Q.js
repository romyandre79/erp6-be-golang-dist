import{_ as ne}from"./DFX9B2i2.js";import{q as Ie,k as A,e as Q,c as k,o as w,a as l,t as V,b as T,n as B,F as Y,r as X,s as oe,m as S,v as O,x as te,h as re,y as se,z as ze,A as Be,j as W,B as ie,l as Le,w as U,g as C,d as M,C as de,D as Fe}from"#entry";import{u as Je}from"./bU7HDp6y.js";import{t as Ye}from"./CCayPtYg.js";import{u as Xe}from"./BoNypvcG.js";import"./Stxcct-8.js";import"./acWDpS9X.js";import"./F2cpyflp.js";const qe=Ie("dbobject",()=>{const i=A([]),b=A({dbobjectid:"",objectname:"",dbobjecttypeid:"",objectcontent:"",objectversion:"",ispublished:0,comment:""}),r=A(!1),m=Je();async function p(){r.value=!0;try{let n=new FormData;n.append("flowname","searchcombodbobjecttype"),n.append("menu","admin"),n.append("search","true");let d=await m.post("/admin/execute-flow",n);i.value=d?.data?.data??{},n=new FormData,n.append("flowname","searchdbobject"),n.append("menu","admin"),n.append("search","true"),d=await m.post("/admin/execute-flow",n),i.value=d?.data?.data??{}}finally{r.value=!1}}async function $(n){r.value=!0;try{const d=new FormData;d.append("flowname","getdbobject"),d.append("menu","admin"),d.append("search","true"),d.append("dbobjectid",n);const j=await m.post("/admin/execute-flow",d);b.value=j?.data?.data??{}}finally{r.value=!1}}async function y(n){try{const d=new FormData;d.append("flowname","modifdbobject"),d.append("menu","admin"),d.append("search","true"),d.append("dbobjectid",n.dbobjectid),d.append("objectname",n.objectname),d.append("dbobjecttypeid",n.dbobjecttypeid),d.append("objectcontent",n.objectcontent),d.append("ispublished",n.ispublished),d.append("comment",n.comment),await m.post("/admin/execute-flow",d)}finally{r.value=!1}}async function o(n){try{const d=new FormData;d.append("flowname","purgedbobject"),d.append("menu","admin"),d.append("search","true"),d.append("dbobjectid",n),await m.post("/admin/execute-flow",d)}finally{r.value=!1}}return{fetchAll:p,fetch:$,saveTable:y,purgeTable:o,dbobject:b,dbobjects:i,loading:r}}),Ze=["data-table-id"],He={class:"flex items-center justify-between p-2 bg-gray-800 text-white rounded-t"},Ge={class:"font-medium"},Ke={class:"flex gap-1"},We={class:"p-2 text-xs"},Qe=["data-col-index"],_e={class:"w-6 text-gray-600"},et={class:"flex-1 truncate"},tt={class:"text-gray-500 text-[11px]"},nt=["onPointerdown"],ot=Q({__name:"CanvasTable",props:{table:{type:Object,required:!0}},emits:["dragstart","select","duplicate","delete","start-link"],setup(i){return(b,r)=>{const m=ne;return w(),k("div",{class:"absolute shadow-lg rounded border bg-white cursor-move",style:oe({left:i.table.x+"px",top:i.table.y+"px",width:i.table.width+"px"}),draggable:"true",onDragstart:r[2]||(r[2]=p=>b.$emit("dragstart",i.table,p)),onDblclick:r[3]||(r[3]=p=>b.$emit("select",i.table.id)),"data-table-id":i.table.id},[l("div",He,[l("div",Ge,V(i.table.name||"table_"+i.table.id),1),l("div",Ke,[T(m,{icon:"heroicons:document-duplicate",onClick:r[0]||(r[0]=B(p=>b.$emit("duplicate",i.table),["stop"])),title:"Duplicate",class:"text-xs px-2"}),T(m,{icon:"heroicons:trash",onClick:r[1]||(r[1]=B(p=>b.$emit("delete",i.table.id),["stop"])),title:"Delete",class:"text-xs px-2"})])]),l("div",We,[(w(!0),k(Y,null,X(i.table.columns,(p,$)=>(w(),k("div",{key:$,class:"flex items-center gap-2","data-col-index":$},[l("span",_e,V($+1),1),l("span",et,V(p.name),1),l("span",tt,V(p.type||""),1),l("button",{onPointerdown:B(y=>b.$emit("start-link",i.table.id,$,y),["stop","prevent"]),class:"w-4 h-4 rounded-full bg-blue-500",title:"Start relation"},null,40,nt)],8,Qe))),128))])],44,Ze)}}}),lt=Object.assign(ot,{__name:"CanvasTable"}),at={class:"bg-purple-600 text-white text-xs px-2 py-1 rounded-t-xl cursor-move flex items-center justify-between"},st={class:"flex items-center"},it=Q({__name:"CanvasArea",props:{area:{type:Object,required:!0}},emits:["start-drag","start-resize","export","delete"],setup(i){return(b,r)=>{const m=ne;return w(),k("div",{class:"absolute rounded-xl border border-purple-400 bg-purple-200/30",style:oe({left:i.area.x+"px",top:i.area.y+"px",width:i.area.width+"px",height:i.area.height+"px"}),onMousedown:r[4]||(r[4]=p=>b.$emit("start-drag",i.area,p))},[l("div",at,[S(l("input",{"onUpdate:modelValue":r[0]||(r[0]=p=>i.area.name=p),class:"bg-purple-600 outline-none flex-1 rounded px-2"},null,512),[[O,i.area.name]]),l("div",st,[T(m,{onClick:r[1]||(r[1]=B(p=>b.$emit("export",i.area),["stop"])),class:"text-white hover:text-blue-300 font-bold mr-2",title:"Export Area",icon:"heroicons:arrow-down-tray"}),T(m,{onClick:r[2]||(r[2]=B(p=>b.$emit("delete",i.area.id),["stop"])),class:"text-white hover:text-red-300 font-bold",title:"Delete Area",icon:"heroicons:trash"})])]),l("div",{class:"absolute bottom-0 right-0 w-4 h-4 bg-purple-600 cursor-se-resize rounded",onMousedown:r[3]||(r[3]=B(p=>b.$emit("start-resize",i.area,p),["stop"]))},null,32)],36)}}}),dt=Object.assign(it,{__name:"CanvasArea"}),rt={class:"absolute right-0 top-0 bottom-0 w-96 border-l bg-white p-4 overflow-auto z-10 shadow-lg"},ut={class:"mt-4"},ct={class:"flex gap-2 mt-1"},mt={key:0,class:"space-y-4"},pt={class:"text-lg font-semibold"},bt={class:"flex gap-2 mt-1"},ft={class:"mt-2 space-y-2"},vt=["onUpdate:modelValue"],yt=["onUpdate:modelValue"],xt=["onUpdate:modelValue"],gt=["onUpdate:modelValue"],wt=["onClick"],ht={class:"flex gap-2"},kt={class:"flex gap-2 mt-1"},$t={class:"mt-4"},jt={key:0},Ct={class:"text-sm"},Tt={class:"flex gap-2"},At=["onClick"],St={key:1,class:"text-gray-400 text-sm"},Dt=Q({__name:"PropertiesPanel",props:{selectedTable:Object,relations:{type:Array,default:()=>[]},jsonPreview:String,aiDescription:String},emits:["ai-parse","remove-column","add-column","ai-suggest-types","apply-json","copy-json","remove-relation","update:jsonPreview","update:aiDescription"],setup(i,{emit:b}){const r=i,m=b,p=te({get:()=>r.aiDescription,set:y=>m("update:aiDescription",y)}),$=te({get:()=>r.jsonPreview,set:y=>m("update:jsonPreview",y)});return(y,o)=>(w(),k("aside",rt,[l("div",ut,[o[13]||(o[13]=l("label",{class:"text-sm font-semibold"},"AI Prompt",-1)),l("div",ct,[S(l("textarea",{"onUpdate:modelValue":o[0]||(o[0]=n=>p.value=n),placeholder:"e.g. Customer table with id, name, email",class:"flex-1 p-2 border rounded"},null,512),[[O,p.value]]),l("button",{onClick:o[1]||(o[1]=n=>y.$emit("ai-parse",p.value)),class:"px-3 py-1 bg-yellow-500 text-white rounded"}," Generate ")])]),i.selectedTable?(w(),k("div",mt,[l("h2",pt,"Properties — "+V(i.selectedTable.name||"Untitled"),1),l("div",null,[o[14]||(o[14]=l("label",{class:"text-sm text-gray-600"},"Table Name",-1)),S(l("input",{"onUpdate:modelValue":o[2]||(o[2]=n=>i.selectedTable.name=n),class:"w-full mt-1 p-2 border rounded"},null,512),[[O,i.selectedTable.name]])]),l("div",null,[o[15]||(o[15]=l("label",{class:"text-sm text-gray-600"},"Comment",-1)),S(l("input",{"onUpdate:modelValue":o[3]||(o[3]=n=>i.selectedTable.comment=n),class:"w-full mt-1 p-2 border rounded"},null,512),[[O,i.selectedTable.comment]])]),l("div",null,[o[16]||(o[16]=l("label",{class:"text-sm text-gray-600"},"Is Published",-1)),S(l("input",{type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=n=>i.selectedTable.ispublished=n),class:"w-full mt-1 p-2 border rounded"},null,512),[[se,i.selectedTable.ispublished]])]),l("div",null,[o[17]||(o[17]=l("label",{class:"text-sm text-gray-600"},"Position",-1)),l("div",bt,[S(l("input",{type:"number","onUpdate:modelValue":o[5]||(o[5]=n=>i.selectedTable.x=n),class:"w-1/3 p-2 border rounded"},null,512),[[O,i.selectedTable.x,void 0,{number:!0}]]),S(l("input",{type:"number","onUpdate:modelValue":o[6]||(o[6]=n=>i.selectedTable.y=n),class:"w-1/3 p-2 border rounded"},null,512),[[O,i.selectedTable.y,void 0,{number:!0}]]),S(l("input",{type:"number","onUpdate:modelValue":o[7]||(o[7]=n=>i.selectedTable.width=n),class:"w-1/3 p-2 border rounded"},null,512),[[O,i.selectedTable.width,void 0,{number:!0}]])])]),l("div",null,[o[19]||(o[19]=l("label",{class:"text-sm text-gray-600"},"Columns",-1)),l("div",ft,[(w(!0),k(Y,null,X(i.selectedTable.columns,(n,d)=>(w(),k("div",{key:d,class:"flex items-center gap-2"},[S(l("input",{"onUpdate:modelValue":j=>n.name=j,placeholder:"name",class:"flex-1 p-2 border rounded"},null,8,vt),[[O,n.name]]),S(l("select",{"onUpdate:modelValue":j=>n.type=j,placeholder:"type",class:"w-36 p-2 border rounded"},[...o[18]||(o[18]=[Be('<option value="auto">Auto Increment</option><option value="text">Text</option><option value="longtext">Long Text</option><option value="number">Number</option><option value="integer">Integer</option><option value="timestamp">Time stamp</option><option value="boolean">Boolean</option>',7)])],8,yt),[[ze,n.type]]),S(l("input",{type:"checkbox","onUpdate:modelValue":j=>n.allownull=j,placeholder:"type",class:"w-36 p-2 border rounded"},null,8,xt),[[se,n.allownull]]),S(l("input",{"onUpdate:modelValue":j=>n.default=j,placeholder:"default",class:"flex-1 p-2 border rounded"},null,8,gt),[[O,n.default]]),l("button",{onClick:j=>y.$emit("remove-column",d),class:"px-2 py-1 bg-red-500 text-white rounded"},"-",8,wt)]))),128)),l("div",ht,[l("button",{onClick:o[8]||(o[8]=n=>y.$emit("add-column")),class:"px-3 py-1 bg-blue-600 text-white rounded"},"Add Column"),l("button",{onClick:o[9]||(o[9]=n=>y.$emit("ai-suggest-types",i.selectedTable)),class:"px-3 py-1 bg-yellow-500 text-white rounded"}," AI Suggest Types ")])])]),l("div",null,[o[20]||(o[20]=l("label",{class:"text-sm text-gray-600"},"Raw JSON",-1)),S(l("textarea",{"onUpdate:modelValue":o[10]||(o[10]=n=>$.value=n),rows:"6",class:"w-full p-2 border rounded mt-1 text-xs font-mono"},null,512),[[O,$.value]]),l("div",kt,[l("button",{onClick:o[11]||(o[11]=n=>y.$emit("apply-json",$.value)),class:"px-3 py-1 bg-green-600 text-white rounded text-xs"}," Apply "),l("button",{onClick:o[12]||(o[12]=n=>y.$emit("copy-json",$.value)),class:"px-3 py-1 bg-gray-500 text-white rounded text-xs"}," Copy ")])])])):re("",!0),l("div",$t,[o[21]||(o[21]=l("h3",{class:"font-semibold"},"Relations",-1)),i.relations.length?(w(),k("div",jt,[(w(!0),k(Y,null,X(i.relations,n=>(w(),k("div",{key:n.id,class:"flex items-center justify-between mt-2"},[l("div",Ct,V(n.from.table)+"."+V(n.from.col)+" ➜ "+V(n.to.table)+"."+V(n.to.col??"-"),1),l("div",Tt,[l("button",{onClick:d=>y.$emit("remove-relation",n.id),class:"px-2 py-1 bg-red-500 text-white rounded"}," Delete ",8,At)])]))),128))])):(w(),k("div",St,"No relations"))])]))}}),Pt=Object.assign(Dt,{__name:"PropertiesPanel"});function Nt(){const i=W([]),b=W([]),r=W([]),m=A(1),p=.1,$=.2,y=3,o=A(null),n=A({x:0,y:0}),d=A(null),j=A(null),L=A({x:0,y:0}),q=A([]),R=W({active:!1,from:null,sx:0,sy:0,path:""});function F(){m.value=Math.min(m.value+p,y)}function J(){m.value=Math.max(m.value-p,$)}function Z(){m.value=1}function g(P,E,I,D){const z=(P+I)/2;return`M ${P} ${E} C ${z} ${E} ${z} ${D} ${I} ${D}`}function H(){b.forEach(P=>{const E=i.find(h=>h.id===P.from.table),I=i.find(h=>h.id===P.to.table);if(!E||!I)return;const D=E.y+36+P.from.col*24,z=E.x+E.width,G=I.y+36+P.to.col*24,K=I.x;P.path=g(z,D,K,G)})}return ie(i,H,{deep:!0}),ie(b,H,{deep:!0}),{tables:i,relations:b,areas:r,zoom:m,dragging:o,offset:n,activeArea:d,areaMode:j,areaOffset:L,activeAreaTables:q,linkPreview:R,zoomIn:F,zoomOut:J,resetZoom:Z,makePath:g,computeRelationsPaths:H}}const Ot={class:"h-screen flex flex-col bg-gray-50"},Rt={class:"flex items-center justify-between p-4 border-b bg-white sticky"},Et={class:"flex items-center gap-2"},Ut={class:"flex items-center gap-2"},Mt={class:"flex-1 relative overflow-hidden"},Vt={class:"absolute inset-0 overflow-auto"},It={class:"absolute inset-0 pointer-events-none",style:{overflow:"visible"}},zt=["d"],Bt=["d"],Gt=Q({__name:"dbobject",setup(i){let b=1,r=1,m=1;const p=Xe(),$=qe(),y=A(null),{tables:o,relations:n,areas:d,zoom:j,dragging:L,offset:q,activeArea:R,areaMode:F,areaOffset:J,activeAreaTables:Z,linkPreview:g,zoomIn:H,zoomOut:P,resetZoom:E,makePath:I,computeRelationsPaths:D}=Nt(),z=A(null),G=A(""),K=A(""),h=te(()=>o.find(t=>t.id===z.value)||null);function ue(t){z.value=t;const e=o.find(s=>s.id===t);G.value=e?JSON.stringify(e,null,2):""}function ce(){let t=40,e=40;if(R.value){const a=R.value;t=a.x+40,e=a.y+40}const s={id:b++,dbid:"",name:`table_${b}`,x:t,y:e,width:240,columns:[{name:"id",type:"auto"},{name:"name",type:"text"}]};o.push(s)}function me(){o.length,ce()}function pe(t,e){L.value=t.id;const s=e.target.getBoundingClientRect();q.value={x:e.clientX-s.left,y:e.clientY-s.top}}function be(t){const e=y.value.getBoundingClientRect();if(!L.value)return;const s=o.find(a=>a.id===L.value);s&&(s.x=t.clientX-e.left-q.value.x,s.y=t.clientY-e.top-q.value.y,L.value=null,D())}function fe(t){let e=100,s=100;if(d.length>0){const a=d[d.length-1];e=a.x+a.width+40,s=a.y}m++,d.push({id:m,name:"Area "+m,x:e,y:s,width:400,height:300,color:"#e3e9ff"})}function ve(t,e){R.value=t,F.value="move",J.value={x:e.clientX-t.x,y:e.clientY-t.y},Z.value=o.filter(s=>s.x>=t.x&&s.x<=t.x+t.width&&s.y>=t.y&&s.y<=t.y+t.height),window.addEventListener("mousemove",_),window.addEventListener("mouseup",ee)}function ye(t,e){R.value=t,F.value="resize",J.value={x:e.clientX,y:e.clientY},window.addEventListener("mousemove",_),window.addEventListener("mouseup",ee)}function _(t){if(!R.value)return;const e=R.value;if(F.value==="move"){const s=t.clientX-J.value.x,a=t.clientY-J.value.y,f=s-e.x,v=a-e.y;e.x=s,e.y=a,Z.value.forEach(c=>{c.x+=f,c.y+=v}),D()}else F.value==="resize"&&(e.width=Math.max(100,t.clientX-e.x),e.height=Math.max(100,t.clientY-e.y))}function ee(){R.value=null,Z.value=[],window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",ee)}function xe(t,e,s){const a=y.value.getBoundingClientRect(),f=o.find(x=>x.id===t);if(!f)return;const v=f.y+36+e*24;g.active=!0,g.from={table:t,col:e},g.sx=f.x+f.width,g.sy=v,le(s.clientX-a.left,s.clientY-a.top);const c=x=>le(x.clientX-a.left,x.clientY-a.top),u=x=>ge(x,c,u);window.addEventListener("pointermove",c),window.addEventListener("pointerup",u)}function le(t,e){g.path=I(g.sx,g.sy,t,e)}function ge(t,e,s){if(window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",s),!g.active)return;const a=y.value.getBoundingClientRect(),f=t.clientX-a.left,v=t.clientY-a.top;let c=null;for(const u of o)if(f>=u.x&&f<=u.x+u.width&&v>=u.y&&v<=u.y+200){const x=Math.floor((v-(u.y+36))/24);if(x>=0&&x<u.columns.length){c={table:u.id,col:x};break}}if(c){const u={id:r++,from:{table:g.from.table,col:g.from.col,colName:o.find(N=>N.id===g.from.table).columns[g.from.col].name},to:{table:c.table,col:c.col,colName:o.find(N=>N.id===c.table).columns[c.col].name},path:""};n.some(N=>N.from.table===g.from.table&&N.from.col===g.from.col&&N.to.table===c.table&&N.to.col===c.col)||(n.push(u),D())}g.active=!1,g.path=""}function we(t){const e=JSON.parse(JSON.stringify(t));e.id=b++,e.dbid="",e.x+=20,e.y+=20,e.name=t.name+"_copy",o.push(e),D()}async function he(t){if(!confirm("Are you sure to delete Table?"))return;const e=o.findIndex(a=>a.id===t),s=o.find(a=>a.id===t);s.dbid&&await $.purgeTable(s.dbid),e>=0&&o.splice(e,1);for(let a=n.length-1;a>=0;a--)(n[a].from.table===t||n[a].to.table===t)&&n.splice(a,1)}async function ke(t){if(!confirm("Are you sure to delete Area ?"))return;const e=d.findIndex(s=>s.id===t);e>=0&&d.splice(e,1)}function $e(){h.value&&h.value.columns.push({name:"new_col",type:"varchar"})}function je(t){h.value&&h.value.columns.splice(t,1)}function Ce(t){const e=n.findIndex(s=>s.id===t);e>=0&&n.splice(e,1)}function Te(t){if(h.value)try{const e=JSON.parse(t);h.value.name=e.name||h.value.name,h.value.x=Number(e.x??h.value.x),h.value.y=Number(e.y??h.value.y),h.value.width=Number(e.width??h.value.width),Array.isArray(e.columns)&&(h.value.columns=e.columns),D(),alert("Applied to selected table")}catch{alert("Invalid JSON")}}function Ae(t){navigator.clipboard.writeText(t).then(()=>alert("Copied"))}async function Se(){confirm("Reset design?")&&await ae()}function De(){console.log("AI Suggest Relations")}function Pe(t){console.log("AI Parse",t)}function Ne(t){console.log("AI Suggest Columns",t)}function Oe(){y.value!==null&&Ye(y.value,{cacheBust:!0,filter:t=>t.tagName!=="i"}).then(t=>{const e=document.createElement("a");e.download="database-design.png",e.href=t,e.click()}).catch(t=>{console.error(t)})}function Re(t){}async function Ee(){if(!o.length)return alert("No tables to save");try{for(const t of Fe(o)){const e={table:t,relations:n.filter(c=>c.from.table===t.id||c.to.table===t.id).map(c=>({id:c.id,from:{...c.from,table:o.find(u=>u.id===c.from.table)?.dbid},to:{...c.to,table:o.find(u=>u.id===c.to.table)?.dbid}})),areas:d},s={dbobjectid:t.dbid?String(t.dbid):"",objectname:t.name,dbobjecttypeid:"1",objectcontent:JSON.stringify(e),objectversion:"1",ispublished:t.ispublished?1:0,comment:t.comment||""},a=await $.saveTable(s),f=a?.data?.data??a,v=f?.dbobjectid??f?.dbobjectid??null;if(v){const c=o.find(u=>u.id===t.id);c&&(c.dbid=v)}}p.add({title:"Success",description:"Runtime schema saved successfully",color:"success"})}catch(t){console.error(t),p.add({title:"Error",description:String(t),color:"error"})}}async function ae(){o.splice(0,o.length),n.splice(0,n.length),d.splice(0,d.length),b=1,m=1,r=1,z.value=null,await $.fetchAll();const t=new Set,e=[],s={};($.dbobjects||[]).forEach(a=>{const f=a?.dbobjectid?String(a.dbobjectid):a?.objectname??"";f&&(t.has(f)||(t.add(f),e.push(a)))}),e.forEach((a,f)=>{const v=Ue(a,f);s[a.dbobjectid]=v.id,o.push(v)}),b=Math.max(...o.map(a=>a.id),0)+1,Ve(e,s),D()}function Ue(t,e){let s=0,a=0,f=120,v=[];if(t.objectcontent)try{const u=JSON.parse(t.objectcontent);u?.table?.columns&&Array.isArray(u.table.columns)&&(v=u.table.columns.map(x=>({name:x.name||"col",type:x.type||"text",allownull:x.allownull??!1,default:x.default??""}))),s=u?.table?.x??40+e%4*340,a=u?.table?.y??40+Math.floor(e/4)*200,f=u?.table?.width??240,u.areas&&u.areas.length>0&&u.areas.forEach(x=>{d.find(N=>N.id==x.id)==null&&Me(x)})}catch(u){console.warn(`Invalid objectcontent JSON for ${t.objectname}`,u)}return{id:b++,dbid:t.dbobjectid??"",name:t.objectname||`table_${e+1}`,x:s,y:a,width:f,columns:v,ispublished:t.ispublished==1,comment:t.comment??""}}function Me(t){const e={id:t.id,name:t.name,x:t.x,y:t.y,width:t.width,height:t.height,color:t.color,type:"area"};d.push(e),m=t.id}function Ve(t,e){n.splice(0,n.length);const s=new Set;t.forEach(a=>{if(!a.objectcontent)return;let f=null;try{f=JSON.parse(a.objectcontent)}catch{return}Array.isArray(f.relations)&&f.relations.forEach(v=>{const c=e[v.from.table],u=e[v.to.table];if(!c||!u)return;const x=`${c}|${v.from.col}|${u}|${v.to.col}`;s.has(x)||(s.add(x),n.push({id:r++,from:{table:c,col:v.from.col,colName:v.from.colName},to:{table:u,col:v.to.col,colName:v.to.colName},path:""}))})}),D()}return Le(async()=>{await ae()}),(t,e)=>{const s=ne;return w(),k("div",Ot,[l("header",Rt,[e[14]||(e[14]=l("div",{class:"flex items-center gap-3"},[l("h1",{class:"text-xl font-semibold"},"Database Designer")],-1)),l("div",Et,[T(s,{icon:"heroicons:table-cells",onClick:me,class:"px-3 py-2 rounded bg-green-600 text-white"},{default:U(()=>[...e[5]||(e[5]=[M("Add Table",-1)])]),_:1}),T(s,{icon:"heroicons:square-3-stack-3d",onClick:e[0]||(e[0]=a=>fe()),class:"px-3 py-2 rounded bg-purple-600 text-white"},{default:U(()=>[...e[6]||(e[6]=[M("Add Area",-1)])]),_:1}),T(s,{icon:"heroicons:bookmark-square",onClick:Ee,class:"px-3 py-1 rounded bg-green-600 text-white"},{default:U(()=>[...e[7]||(e[7]=[M("Save",-1)])]),_:1}),T(s,{icon:"heroicons:arrows-right-left",onClick:Se,class:"px-3 py-1 rounded bg-red-500 text-white"},{default:U(()=>[...e[8]||(e[8]=[M("Reset",-1)])]),_:1}),T(s,{icon:"heroicons:building-library",onClick:e[1]||(e[1]=a=>De()),class:"px-3 py-1 bg-purple-500 text-white rounded"},{default:U(()=>[...e[9]||(e[9]=[M(" AI Suggest Relations ",-1)])]),_:1})]),l("div",Ut,[T(s,{icon:"heroicons:bars-4",onClick:Oe,class:"px-3 py-1 bg-indigo-500 text-white rounded"},{default:U(()=>[...e[10]||(e[10]=[M("Export PNG",-1)])]),_:1}),T(s,{icon:"heroicons:magnifying-glass-plus",onClick:C(H),class:"px-3 py-1 bg-blue-500 text-white rounded"},{default:U(()=>[...e[11]||(e[11]=[M("Zoom In",-1)])]),_:1},8,["onClick"]),T(s,{icon:"heroicons:magnifying-glass-minus",onClick:C(P),class:"px-3 py-1 bg-blue-500 text-white rounded"},{default:U(()=>[...e[12]||(e[12]=[M("Zoom Out",-1)])]),_:1},8,["onClick"]),T(s,{icon:"heroicons:arrows-right-left",onClick:C(E),class:"px-3 py-1 bg-gray-500 text-white rounded"},{default:U(()=>[...e[13]||(e[13]=[M("Reset Zoom",-1)])]),_:1},8,["onClick"])])]),l("div",Mt,[l("div",Vt,[l("div",{class:"relative p-4 bg-gray-100 min-w-[2000px] min-h-[2000px]",onDragover:e[2]||(e[2]=B(()=>{},["prevent"])),onDrop:be,ref_key:"canvasRef",ref:y,id:"drawflow",style:oe({transform:`scale(${C(j)})`,transformOrigin:"0 0",width:C(j)<1?`${100/C(j)}%`:"100%",height:C(j)<1?`${100/C(j)}%`:"100%"})},[(w(!0),k(Y,null,X(C(d),a=>(w(),de(dt,{key:a.id,area:a,onStartDrag:ve,onStartResize:ye,onExport:Re,onDelete:ke},null,8,["area"]))),128)),(w(),k("svg",It,[e[15]||(e[15]=l("defs",null,[l("marker",{id:"arrow",markerWidth:"10",markerHeight:"10",refX:"10",refY:"5",orient:"auto"},[l("path",{d:"M0,0 L10,5 L0,10 z",fill:"black"})])],-1)),(w(!0),k(Y,null,X(C(n),a=>(w(),k("g",{key:a.id},[l("path",{d:a.path,stroke:"black","stroke-width":"2",fill:"none","marker-end":"url(#arrow)"},null,8,zt)]))),128)),C(g).active?(w(),k("path",{key:0,d:C(g).path,stroke:"gray","stroke-width":"2",fill:"none","stroke-dasharray":"6 4"},null,8,Bt)):re("",!0)])),(w(!0),k(Y,null,X(C(o),a=>(w(),de(lt,{key:a.id,table:a,onDragstart:pe,onSelect:ue,onDuplicate:we,onDelete:he,onStartLink:xe},null,8,["table"]))),128)),e[16]||(e[16]=l("div",{class:"absolute left-4 bottom-4"},null,-1))],36)]),T(Pt,{selectedTable:h.value,relations:C(n),jsonPreview:G.value,"onUpdate:jsonPreview":e[3]||(e[3]=a=>G.value=a),aiDescription:K.value,"onUpdate:aiDescription":e[4]||(e[4]=a=>K.value=a),onAiParse:Pe,onRemoveColumn:je,onAddColumn:$e,onAiSuggestTypes:Ne,onApplyJson:Te,onCopyJson:Ae,onRemoveRelation:Ce},null,8,["selectedTable","relations","jsonPreview","aiDescription"])])])}}});export{Gt as default};
