import{r as _,y as b,z as I,B as i,ak as l,a_ as t,an as A,aN as h,u as m,Y as R,ay as B,aF as k,am as P}from"./DirAx5lA.js";import{u as C}from"./mra8fcCZ.js";import"#entry";/* empty css        */import"./KobTAp13.js";import"./CHaV0QvJ.js";import"./DQ_kd7ue.js";import"./CoedoqIK.js";function V(){const v=_([]),c=_(""),d=_(!1),p=C(),r="/media";async function u(e=""){d.value=!0;try{const o=await p.get(`${r}?path=${encodeURIComponent(e)}`);v.value=Array.isArray(o)?o:[],c.value=e}catch(o){console.error("Failed to load media",o)}finally{d.value=!1}}async function g(e){const o=new FormData;o.append("file",e),o.append("path",c.value),await p.post(`${r}/upload`,o),await u(c.value)}async function y(e){confirm(`Delete "${e.name}"?`)&&(await p.del(`${r}/delete?path=${encodeURIComponent(e.path)}`),await u(c.value))}async function x(e,o){await p.post(`${r}/rename`,JSON.stringify({oldPath:e,newName:o})),await u(c.value)}async function f(e){await p.post(`${r}/folder`,{path:c.value,folder:e}),await u(c.value)}return{files:v,currentPath:c,loading:d,loadMedia:u,uploadFile:g,deleteFile:y,renameFile:x,createFolder:f}}const z={class:"p-4 shadow-md"},L={class:"flex items-center justify-between mb-3"},O={class:"flex items-center space-x-2 cursor-pointer"},S={class:"text-sm italic"},E={class:"space-x-2"},J={key:0,class:"text-gray-500"},W={key:1,class:"grid grid-cols-6 gap-4"},Y=["onDblclick"],q={class:"text-5xl"},G={key:0},H={key:1},K={key:2},Q={class:"text-xs text-center truncate w-full mt-1"},T={class:"flex space-x-1 mt-1 text-xs text-gray-500"},X=["onClick"],Z=["onClick"],ee={class:"p-4 rounded-lg w-3/4 h-3/4 overflow-auto relative"},te={class:"font-semibold mb-2"},ae={key:0},ne=["src"],se={key:1,class:"text-sm whitespace-pre-wrap"},oe=b({__name:"MediaManager",setup(v){const{files:c,currentPath:d,loading:p,loadMedia:r,uploadFile:u,deleteFile:g,renameFile:y,createFolder:x}=V(),f=_(null),e=_(null),o=C();I(()=>r());function F(a){r(a)}function $(){if(!d.value)return;const a=d.value.split("/").slice(0,-1).join("/");r(a)}function M(a){const s=a.target.files?.[0];s&&u(s),f.value&&(f.value.value="")}async function N(a){const n=prompt("Rename to:",a.name);n&&n!==a.name&&await y(a.path,n)}async function U(){const a=prompt("Folder name:");a&&await x(a)}async function j(a){const n=await o.get(`/media/preview?path=${encodeURIComponent(a.path)}`);e.value=n}function D(a){return[".jpg",".jpeg",".png",".gif",".webp"].includes(a)}return(a,n)=>(l(),i("div",z,[t("div",L,[t("div",O,[t("button",{onClick:$,class:"px-2 py-1 bg-gray-200"},"â¬†"),t("span",S,"Path: "+h(m(d)||"/"),1)]),t("div",E,[t("input",{type:"file",ref_key:"fileInput",ref:f,class:"hidden",onChange:M},null,544),t("button",{class:"btn",onClick:n[0]||(n[0]=()=>f.value.click())},"ðŸ“¤ Upload"),t("button",{class:"btn",onClick:U},"ðŸ“ New Folder"),t("button",{class:"btn",onClick:n[1]||(n[1]=s=>m(r)(m(d)))},"ðŸ”„ Refresh")])]),m(p)?(l(),i("div",J,"Loading...")):(l(),i("div",W,[(l(!0),i(R,null,B(m(c),s=>(l(),i("div",{key:s.path,onDblclick:w=>s.type==="folder"?F(s.path):j(s),class:"flex flex-col items-center p-2 hover:bg-gray-100 cursor-pointer"},[t("div",q,[s.type=="folder"?(l(),i("span",G,"ðŸ“")):s.type?.startsWith("image")?(l(),i("span",H,"ðŸ–¼ï¸")):(l(),i("span",K,"ðŸ“„"))]),t("span",Q,h(s.name),1),t("div",T,[t("button",{onClick:k(w=>N(s),["stop"])},"âœï¸",8,X),t("button",{onClick:k(w=>m(g)(s),["stop"])},"ðŸ—‘ï¸",8,Z)])],40,Y))),128))])),e.value?(l(),i("div",{key:2,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",onClick:n[3]||(n[3]=k(s=>e.value=null,["self"]))},[t("div",ee,[t("button",{onClick:n[2]||(n[2]=s=>e.value=null),class:"absolute top-2 right-2 text-xl"},"âœ–"),t("h3",te,h(e.value.name),1),D(e.value.ext)?(l(),i("div",ae,[t("img",{src:e.value.content,class:"max-w-full max-h-[70vh] mx-auto"},null,8,ne)])):(l(),i("pre",se,h(e.value.content),1))])])):A("",!0)]))}}),ie=Object.assign(oe,{__name:"MediaManager"}),le={class:"min-h-screen bg-gray-50 dark:bg-black p-4"},ve=b({__name:"mediamgr",setup(v){return(c,d)=>(l(),i("div",le,[P(ie)]))}});export{ve as default};
