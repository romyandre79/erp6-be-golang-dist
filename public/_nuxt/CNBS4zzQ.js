import{_ as H}from"./CTPo0qNU.js";import{e as T,k as h,s as A,c,o as d,a as o,m as V,F as N,r as $,D as F,h as b,b as y,B as G,t as C,g as w,H as K,j as Q,l as W,A as X,C as Y,n as J,w as Z,v as ee,S as te}from"#entry";import{a as E,l as M,T as oe,P as re,R as ae,d as ne}from"./BTnM5VfM.js";import{_ as se}from"./CMWow-hH.js";import{u as le}from"./C1IErGjn.js";import{u as de}from"./BDST1DAx.js";import{u as ie}from"./CM07dtpo.js";import"./nBeXhCDW.js";import"./BtOf2Fb3.js";import"./Cmh6H4GH.js";import"./C_kpcGSt.js";import"./QS5m4ZZW.js";import"./up-bPkeT.js";import"./on0lOAqo.js";import"./boeIpb6B.js";import"./CR3KQr8q.js";import"./CD2XDZmH.js";import"./Bhw12tYx.js";const ue={class:"h-full flex flex-row bg-white text-gray-900 shadow-sm border-r"},ce={class:"panel w-12 flex flex-col items-center py-2 bg-gray-800 text-gray-400 border-r border-gray-700 z-20"},me=["onClick","title"],pe={key:0,class:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500"},ve={class:"w-80 flex flex-col bg-gray-50 border-r transition-all duration-300 ease-in-out"},fe={class:"p-3 border-b bg-gray-100 flex justify-between items-center"},be={class:"font-semibold text-sm uppercase text-gray-600"},ge={class:"flex-1 overflow-auto p-3"},he={key:0},ye=["onDragstart"],we={class:"truncate"},xe=["onDragstart"],_e={class:"truncate"},ke={key:1},Se=T({__name:"FormSidebar",setup(P){const f=h("elements"),p=h(!0),_=[{id:"elements",label:"Elements",icon:"heroicons:squares-plus"}],i=A(()=>_.find(a=>a.id===f.value)?.label||"");function v(a){f.value===a?p.value=!p.value:(f.value=a,p.value=!0)}function g(a,n){a.dataTransfer&&(a.dataTransfer.setData("component",JSON.stringify(n)),window.draggingComponent=n)}return(a,n)=>{const k=se;return d(),c("div",ue,[o("div",ce,[(d(),c(N,null,$(_,u=>o("button",{key:u.id,class:F(["w-full relative flex justify-center py-3 mb-1 hover:bg-gray-700 transition-colors",f.value===u.id&&p.value?"text-white":"text-gray-400 hover:text-gray-200"]),onClick:x=>v(u.id),title:u.label},[f.value===u.id&&p.value?(d(),c("div",pe)):b("",!0),y(k,{name:u.icon,class:"w-6 h-6"},null,8,["name"])],10,me)),64))]),V(o("div",ve,[o("div",fe,[o("span",be,C(i.value),1),o("button",{onClick:n[0]||(n[0]=u=>p.value=!1),class:"text-gray-500 hover:text-gray-700"},[y(k,{name:"heroicons:x-mark",class:"w-4 h-4"})])]),o("div",ge,[f.value==="elements"?(d(),c("div",he,[n[1]||(n[1]=o("h2",{class:"font-bold text-sm text-gray-700 mb-3 uppercase tracking-wider"},"Components",-1)),(d(!0),c(N,null,$(w(E),(u,x)=>(d(),c("div",{key:x,class:"p-2 bg-white border rounded mb-1 cursor-grab flex items-center gap-2 hover:border-blue-400 hover:shadow-sm transition-all text-sm",draggable:"true",onDragstart:S=>g(S,u)},[o("span",we,C(u.label),1)],40,ye))),128)),n[2]||(n[2]=o("h3",{class:"font-bold text-sm text-gray-700 mt-4 mb-3 uppercase tracking-wider"},"Containers",-1)),(d(!0),c(N,null,$(w(M),(u,x)=>(d(),c("div",{key:"grp-"+x,class:"p-2 bg-white border rounded mb-1 cursor-grab flex items-center gap-2 hover:border-blue-400 hover:shadow-sm transition-all text-sm",draggable:"true",onDragstart:S=>g(S,u)},[o("span",_e,C(u.label),1)],40,xe))),128))])):b("",!0),f.value==="structure"?(d(),c("div",ke,[...n[3]||(n[3]=[o("div",{class:"text-gray-500 text-sm italic text-center mt-10"}," Structure view is currently on the right panel. ",-1)])])):b("",!0)])],512),[[G,p.value]])])}}}),Ce=Object.assign(Se,{__name:"FormSidebar"}),Ne={class:"flex"},De={class:"flex h-screen overflow-hidden bg-gray-100"},Oe={class:"flex-none bg-white border-r z-10"},$e={class:"flex-1 p-5 overflow-auto w-full bg-white dark:bg-black"},Ie={key:0,class:"flex items-center justify-between sticky top-0 z-50 px-6 py-3 transition-colors duration-300 backdrop-blur-md"},Je={key:0,class:"text-gray-400 text-center py-20"},Te=["onClick"],Ae={key:1,class:"panel font-mono text-sm rounded-xl p-4 overflow-auto max-h-[80vh]"},Ve={class:"w-1/4 bg-white border-l p-4 overflow-y-auto dark:bg-black"},Fe={key:0},et=T({__name:"[...slug]",setup(P){const f=K(),p=le(),_=h(""),i=h([]),v=h(null),g=h(null),a=h(!1),n=h(!0),{getMenuForm:k}=de(),u=ie();function x(e){const t=E.find(s=>s.type===e)||M.find(s=>s.type===e);return t?JSON.parse(JSON.stringify(t.props||{})):{}}const S=e=>{const t=e.dataTransfer?.getData("component");if(!t)return;const s=JSON.parse(t),l=x(s.type),m={id:Math.random().toString(36).substr(2,9),type:s.type,label:s.label,props:{...l},children:s.children?[]:void 0};i.value.push(m)},R=([e,t])=>{const s=l=>{for(const m of l){if(m.id===e)return Array.isArray(m.children)||(m.children=[]),m.children.push(t),!0;if(m.children&&s(m.children))return!0}return!1};s(i.value)},U=e=>{if(!confirm(`Are you sure you want to delete "${e.label}"?`))return;const t=s=>{const l=s.findIndex(m=>m.id===e.id);if(l!==-1)return s.splice(l,1),!0;for(const m of s)if(m.children&&t(m.children))return!0;return!1};t(i.value),v.value=null},D=e=>{v.value=e},j=()=>{a.value=!a.value},B=()=>{n.value=!n.value},z=async()=>{i.value=[]},L=async()=>{const e=new FormData;e.append("flowname","modifmenuaccess"),e.append("menu","admin"),e.append("search","true"),e.append("menuaccessid",r.menuAccessId),e.append("menuname",r.menuName),e.append("description",r.description),e.append("menucode",r.menuCode),e.append("menuurl",r.menuUrl),e.append("menuicon",r.menuIcon),e.append("moduleiId",r.moduleId),e.append("sortorder",r.sortOrder),e.append("menuversion",r.menuVersion),e.append("menutype",r.menuType),e.append("recordstatus",r.recordStatus),e.append("menuform",JSON.stringify(_.value));try{const t=await u.post("admin/execute-flow",e);t?.code==200?p.add({title:"Success",description:"Runtime schema saved successfully",color:"success"}):p.add({title:"Error",description:t.message,color:"error"})}catch(t){p.add({title:"Error",description:t,color:"error"})}},r=Q({menuAccessId:Number,menuName:String,description:String,menuCode:String,menuUrl:String,menuIcon:String,moduleId:Number,sortOrder:Number,menuVersion:String,menuType:String,recordStatus:Number}),I=async()=>{try{const e=await k(f.params.slug);e?.code==200?(r.menuAccessId=e?.data.data.menuaccessid,r.menuName=e?.data.data.menuname,r.description=e?.data.data.description,r.menuCode=e?.data.data.menucode,r.menuUrl=e?.data.data.menuurl,r.menuIcon=e?.data.data.menuicon,r.moduleId=e?.data.data.moduleid,r.sortOrder=e?.data.data.sortorder,r.menuVersion=e?.data.data.menuversion,r.menuType=e?.data.data.menutype,r.recordStatus=e?.data.data.recordstatus,e?.data.data.menuform!=""&&(g.value=e?.data?.data.menuform,i.value=JSON.parse(e?.data?.data.menuform))):console.error("Invalid response from ",e)}catch(e){console.error("Error loading :",e)}},q=async()=>{const e=window.prompt("Copy Schema From ? ");if(console.log(e),e)try{const t=await k(e);t?.code==200?t?.data.data.menuform!=""&&(g.value=t?.data?.data.menuform,i.value=JSON.parse(t?.data?.data.menuform)):console.error("Invalid response from ",t)}catch(t){console.error("Error loading :",t)}else console.warn("Empty")};W(async()=>{I()});const O=A({get(){return JSON.stringify(i.value,null,2)},set(e){try{i.value=JSON.parse(e)}catch(t){console.error(t)}}});return X(i,e=>{_.value=e,g.value=e},{deep:!0,immediate:!0}),(e,t)=>{const s=H;return d(),c(N,null,[o("div",Ne,[o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:L}," ðŸ’¾ Save Schema "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:z}," Clear Schema "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:I}," ðŸ“‚ Load Schema "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:q}," ðŸ“‚ Copy From ... "),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:j},C(a.value?"ðŸ§± Edit Mode":"ðŸ‘ Preview"),1),o("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:B},C(n.value?"ðŸ§± Debug Off":"ðŸ‘ Debug On"),1)]),o("div",De,[o("div",Oe,[y(Ce)]),o("main",$e,[a.value?(d(),c("div",Ie,[g.value?(d(),Y(s,{key:0,schema:g.value,menuName:w(r).menuName,formType:w(r).menuType,title:w(r).description},null,8,["schema","menuName","formType","title"])):b("",!0)])):b("",!0),a.value?b("",!0):(d(),c("div",{key:1,class:"min-h-[80vh] rounded-xl shadow-inner",onDragover:t[2]||(t[2]=J(()=>{},["prevent"])),onDrop:S},[i.value?.length?b("",!0):(d(),c("div",Je," Drag components or containers here ")),y(w(ne),{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),group:"components","item-key":"id",class:"space-y-3"},{item:Z(({element:l})=>[o("div",{class:F(["panel border rounded p-3 cursor-pointer relative group",{"border-blue-600":v.value?.id===l.id}]),onClick:J(m=>D(l),["stop"])},[y(ae,{node:l,preview:a.value,showJson:n.value,selected:v.value,onSelect:D,onDropChild:R,onDelete:U},null,8,["node","preview","showJson","selected"])],10,Te)]),_:1},8,["modelValue"]),n.value&&!a.value?(d(),c("div",Ae,[t[4]||(t[4]=o("h1",null,"Debug",-1)),V(o("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>te(O)?O.value=l:null),class:"w-full h-120 p-3 border rounded font-mono text-sm"},null,512),[[ee,w(O)]])])):b("",!0)],32))]),o("aside",Ve,[t[6]||(t[6]=o("h3",{class:"font-semibold mb-3"},"Form Structure",-1)),y(oe,{nodes:i.value,selected:v.value,onSelect:D},null,8,["nodes","selected"]),t[7]||(t[7]=o("hr",{class:"my-4"},null,-1)),v.value&&!a.value?(d(),c("div",Fe,[t[5]||(t[5]=o("h3",{class:"font-semibold mb-3"},"Properties",-1)),y(re,{modelValue:v.value.props,"onUpdate:modelValue":t[3]||(t[3]=l=>v.value.props=l)},null,8,["modelValue"])])):b("",!0)])])],64)}}});export{et as default};
