import{q as w,aP as y,k as l,l as g,aL as S,A as T}from"#entry";import{u as b}from"./Bhw12tYx.js";import{u as A}from"./CM07dtpo.js";const C=w("theme",()=>{const u=A(),t=y("theme",{default:()=>""}),o=l(t.value),n=l(null),s=l([]),r=b();async function i(){const a=new FormData,e=await u.post("auth/load-theme",a);s.value=e.data?.data||[]}const h=async a=>{const e=new FormData;e.append("flowname","getthemebyname"),e.append("menu","admin"),e.append("search","true"),e.append("themename",a);const p=await u.post("admin/execute-flow",e);n.value=p.data?.data||[]},f=async a=>{const e=new FormData;e.append("flowname","modiftheme"),e.append("themedata",a),e.append("themeid",n.value.themeid),e.append("themename",n.value.themename),e.append("createdby",n.value.createdby),e.append("description",n.value.description),e.append("recordstatus",n.value.recordstatus),e.append("menu","admin"),e.append("search","false"),await u.post("admin/execute-flow",e)},v=async()=>{m(t.value)},m=async a=>{if(o.value===a&&s.value.length>0)return;await i();const e=s.value.find(c=>c.themeid===Number(a));if(!e)return;const p=typeof e.themedata=="string"?JSON.parse(e.themedata):e.themedata;for(const[c,d]of Object.entries(p))d!=null&&d!==""&&document.documentElement.style.setProperty(`--${c}`,String(d));o.value!==a&&(o.value=a),t.value=a,document.documentElement.setAttribute("data-theme",a)};return g(async()=>{await r.loadAuth(),r.token?(t.value=r.user?.themeid,await i(),t.value&&m(t.value)):S("/login")}),T(o,(a,e)=>{a!==e&&m(a)}),{theme:o,themeCookie:t,themeData:n,themeList:s,applyTheme:m,applyCurrentTheme:v,loadThemes:i,loadSingleThemes:h,saveActiveTheme:f}});export{C as u};
