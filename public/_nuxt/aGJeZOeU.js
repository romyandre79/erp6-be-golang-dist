const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DhkvLtRd.js","./DH2n3Tqk.js","./atadKu7o.js","./KobTAp13.js","./vendor-drawflow.D47m1JE_.css","./BXI2M5or.js","./B3hjldT8.js","./entry.Bk-kIeZj.css","./vendor-icons.Bt8h_iO_.css","./vendor-vue.Bz_NoKHc.css","./DnqiU5Z1.js","./BNTewa7k.js","./Cp-22nQC.js","./TreeView.D8CDdj64.css","./CcFEbDs5.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./B3hjldT8.js";import{_ as j}from"./CGyzmy_M.js";import{y as $,r as m,d as Y,z as q,a as G,w as H,B as p,a_ as a,aN as N,am as h,u as l,an as f,aj as K,aF as D,al as Q,b0 as W,b1 as X,i as Z,Y as ee,ak as c,P as w,b5 as oe,b6 as te}from"./DH2n3Tqk.js";import{a as re,l as ae}from"./DnqiU5Z1.js";import{M as ne}from"#entry";import{s as se}from"./BXI2M5or.js";import{u as de}from"./BGTJGQ9y.js";import{u as le}from"./C1AnPZyN.js";import"./KobTAp13.js";/* empty css        */import"./Bu8C_CX3.js";const ue={class:"flex"},ie={class:"flex h-screen overflow-hidden bg-gray-100"},ce={class:"flex-none bg-white border-r z-10"},me={class:"flex-1 p-5 overflow-auto w-full bg-white dark:bg-black"},pe={key:0,class:"flex items-center justify-between sticky top-0 z-50 px-6 py-3 transition-colors duration-300 backdrop-blur-md"},fe={key:0,class:"text-gray-400 text-center py-20"},ve=["onClick"],ye={key:1,class:"panel font-mono text-sm rounded-xl p-4 overflow-auto max-h-[80vh]"},he={class:"w-1/4 bg-white border-l p-4 overflow-y-auto dark:bg-black"},be={key:0},Ee=$({__name:"[...slug]",setup(we){const I=w(()=>b(()=>import("./DhkvLtRd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url)),O=w(()=>b(()=>import("./BNTewa7k.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10]),import.meta.url)),V=w(()=>b(()=>import("./Cp-22nQC.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,13]),import.meta.url)),E=w(()=>b(()=>import("./CcFEbDs5.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9]),import.meta.url)),A=ne(),g=se(),x=m(""),d=m([]),u=m(null),v=m(null),i=m(!1),y=m(!0),{getMenuForm:S}=de(),T=le();function J(e){const o=re.find(r=>r.type===e)||ae.find(r=>r.type===e);return o?JSON.parse(JSON.stringify(o.props||{})):{}}const P=e=>{const o=e.dataTransfer?.getData("component");if(!o)return;const r=JSON.parse(o),n=J(r.type),s={id:Math.random().toString(36).substr(2,9),type:r.type,label:r.label,props:{...n},children:r.children?[]:void 0};d.value.push(s)},F=([e,o])=>{const r=n=>{for(const s of n){if(s.id===e)return Array.isArray(s.children)||(s.children=[]),s.children.push(o),!0;if(s.children&&r(s.children))return!0}return!1};r(d.value)},R=e=>{if(!confirm(`Are you sure you want to delete "${e.label}"?`))return;const o=r=>{const n=r.findIndex(s=>s.id===e.id);if(n!==-1)return r.splice(n,1),!0;for(const s of r)if(s.children&&o(s.children))return!0;return!1};o(d.value),u.value=null},_=e=>{u.value=e},M=()=>{i.value=!i.value},U=()=>{y.value=!y.value},B=async()=>{d.value=[]},L=async()=>{const e=new FormData;e.append("flowname","modifmenuaccess"),e.append("menu","admin"),e.append("search","true"),e.append("menuaccessid",t.menuAccessId),e.append("menuname",t.menuName),e.append("description",t.description),e.append("menucode",t.menuCode),e.append("menuurl",t.menuUrl),e.append("menuicon",t.menuIcon),e.append("moduleiId",t.moduleId),e.append("sortorder",t.sortOrder),e.append("menuversion",t.menuVersion),e.append("menutype",t.menuType),e.append("recordstatus",t.recordStatus),e.append("menuform",JSON.stringify(x.value));try{const o=await T.post("admin/execute-flow",e);o?.code==200?g.add({title:"Success",description:"Runtime schema saved successfully",color:"success"}):g.add({title:"Error",description:o.message,color:"error"})}catch(o){g.add({title:"Error",description:o,color:"error"})}},t=Y({menuAccessId:Number,menuName:String,description:String,menuCode:String,menuUrl:String,menuIcon:String,moduleId:Number,sortOrder:Number,menuVersion:String,menuType:String,recordStatus:Number}),C=async()=>{try{const e=await S(A.params.slug);e?.code==200?(t.menuAccessId=e?.data.data.menuaccessid,t.menuName=e?.data.data.menuname,t.description=e?.data.data.description,t.menuCode=e?.data.data.menucode,t.menuUrl=e?.data.data.menuurl,t.menuIcon=e?.data.data.menuicon,t.moduleId=e?.data.data.moduleid,t.sortOrder=e?.data.data.sortorder,t.menuVersion=e?.data.data.menuversion,t.menuType=e?.data.data.menutype,t.recordStatus=e?.data.data.recordstatus,e?.data.data.menuform!=""&&(v.value=e?.data?.data.menuform,d.value=JSON.parse(e?.data?.data.menuform))):console.error("Invalid response from ",e)}catch(e){console.error("Error loading :",e)}},z=async()=>{const e=window.prompt("Copy Schema From ? ");if(console.log(e),e)try{const o=await S(e);o?.code==200?o?.data.data.menuform!=""&&(v.value=o?.data?.data.menuform,d.value=JSON.parse(o?.data?.data.menuform)):console.error("Invalid response from ",o)}catch(o){console.error("Error loading :",o)}else console.warn("Empty")};q(async()=>{C()});const k=G({get(){return JSON.stringify(d.value,null,2)},set(e){try{d.value=JSON.parse(e)}catch(o){console.error(o)}}});return H(d,e=>{x.value=e,v.value=e},{deep:!0,immediate:!0}),(e,o)=>{const r=j;return c(),p(ee,null,[a("div",ue,[a("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:L}," ðŸ’¾ Save Schema "),a("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:B}," Clear Schema "),a("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:C}," ðŸ“‚ Load Schema "),a("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:z}," ðŸ“‚ Copy From ... "),a("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:M},N(i.value?"ðŸ§± Edit Mode":"ðŸ‘ Preview"),1),a("button",{class:"text-black dark:text-white w-full py-1 rounded cursor-pointer",onClick:U},N(y.value?"ðŸ§± Debug Off":"ðŸ‘ Debug On"),1)]),a("div",ie,[a("div",ce,[h(l(I))]),a("main",me,[i.value?(c(),p("div",pe,[v.value?(c(),K(r,{key:0,schema:v.value,menuName:l(t).menuName,formType:l(t).menuType,title:l(t).description},null,8,["schema","menuName","formType","title"])):f("",!0)])):f("",!0),i.value?f("",!0):(c(),p("div",{key:1,class:"min-h-[80vh] rounded-xl shadow-inner",onDragover:o[2]||(o[2]=D(()=>{},["prevent"])),onDrop:P},[d.value?.length?f("",!0):(c(),p("div",fe," Drag components or containers here ")),h(l(te),{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value=n),group:"components","item-key":"id",class:"space-y-3"},{item:Q(({element:n})=>[a("div",{class:oe(["panel border rounded p-3 cursor-pointer relative group",{"border-blue-600":u.value?.id===n.id}]),onClick:D(s=>_(n),["stop"])},[h(l(O),{node:n,preview:i.value,showJson:y.value,selected:u.value,onSelect:_,onDropChild:F,onDelete:R},null,8,["node","preview","showJson","selected"])],10,ve)]),_:1},8,["modelValue"]),y.value&&!i.value?(c(),p("div",ye,[o[4]||(o[4]=a("h1",null,"Debug",-1)),W(a("textarea",{"onUpdate:modelValue":o[1]||(o[1]=n=>Z(k)?k.value=n:null),class:"w-full h-120 p-3 border rounded font-mono text-sm"},null,512),[[X,l(k)]])])):f("",!0)],32))]),a("aside",he,[o[6]||(o[6]=a("h3",{class:"font-semibold mb-3"},"Form Structure",-1)),h(l(V),{nodes:d.value,selected:u.value,onSelect:_},null,8,["nodes","selected"]),o[7]||(o[7]=a("hr",{class:"my-4"},null,-1)),u.value&&!i.value?(c(),p("div",be,[o[5]||(o[5]=a("h3",{class:"font-semibold mb-3"},"Properties",-1)),h(l(E),{modelValue:u.value.props,"onUpdate:modelValue":o[3]||(o[3]=n=>u.value.props=n)},null,8,["modelValue"])])):f("",!0)])])],64)}}});export{Ee as default};
